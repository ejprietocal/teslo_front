import{a as Dt}from"./chunk-G5KA7DMQ.js";import{a as $e}from"./chunk-YFVOBPZ4.js";import{a as ct,b as fe,c as ht,d as ut,e as pt,f as mt,g as ft,h as gt,i as bt,j as vt,l as yt,m as wt,n as _t}from"./chunk-2D4XQHV5.js";import"./chunk-UISL6Y2D.js";import{a as Ct}from"./chunk-2Q24A73Y.js";import{b as xt}from"./chunk-KSPYWLJG.js";import{a as dt}from"./chunk-WAMUCK4W.js";import{h as lt,m as Se}from"./chunk-EJNWX7KC.js";import{a as Ve}from"./chunk-MGM6FGYC.js";import{$ as xe,Bb as Me,Cb as Ee,Db as Ne,Eb as F,Gb as je,Ja as W,Jb as qe,N as nt,T as Z,Ua as pe,Xb as Oe,Za as Fe,_ as Ce,a as Q,aa as ot,b as Ye,ba as rt,db as te,ib as be,mb as L,na as ue,nb as P,ob as B,rb as De,wb as me}from"./chunk-ZMWEMAWI.js";var ge=class i{environments=Ct;http=Z(dt);createCategory(e){return this.http.post(this.environments.URL_CREATE_CATEGORY,e.value)}updateCategory(e,t){return this.http.patch(`${this.environments.URL_UPDATE_CATEGORY}/${t}`,e.value)}getCategories(){return this.http.get(this.environments.URL_GET_CATEGORIES)}deleteCategory(e){return this.http.delete(`${this.environments.URL_DELETE_CATEGORY}/${e}`)}getCategory(e){return this.http.get(`${this.environments.URL_GET_CATEGORY}/${e}`)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=nt({token:i,factory:i.\u0275fac,providedIn:"root"})};var Rt=["createCategory"],Mt=i=>({"border-red-500!":i});function Ht(i,e){i&1&&(L(0,"p",13),F(1,"Este campo es requerido"),P())}function Yt(i,e){i&1&&(L(0,"p",13),F(1,"El nombre debe tener al menos 3 caracteres"),P())}function Ft(i,e){i&1&&(L(0,"p",13),F(1,"Este campo es requerido"),P())}function jt(i,e){i&1&&(L(0,"p",13),F(1,"La descripci\xF3n debe tener al menos 3 caracteres"),P())}var ke=class i{categoryCreatedSignal;categories=[];categoryId;mode;resetForm;createCategory;createCategorySub;createCategoryService=Z(ge);fb=Z(yt);loaderService=Z(Ve);toastr=Z($e);updateCategorySub;constructor(){Oe(()=>{this.categoryId()&&this.mode()==="modify"&&this.createCategoryService.getCategory(this.categoryId()).subscribe({next:e=>{this.form.get("description")?.setValue(e.description),this.form.get("isActive")?.setValue(e.isActive),this.form.get("name")?.setValue(e.name)},error:e=>{console.error("Error al obtener la categor\xEDa:",e),this.loaderService.deactivateInternalSignal(),this.toastr.error(e.error.message)}}),this.resetForm()&&(this.form.reset({name:"",description:"",isActive:!0}),this.resetForm.set(!1))})}textModalmodify={title:"Modificar Categor\xEDa",button:"Modificar"};textModalCreate={title:"Crear Categor\xEDa",button:"Crear"};form=this.fb.group({description:["",[fe.required,fe.minLength(3)]],id_business:[""],isActive:[!0,fe.required],name:["",[fe.required,fe.minLength(3)]]});onSubmitCategory(){this.loaderService.activateInternalSignal();let{id_business:e}=Dt(localStorage.getItem("auth_token"));this.form.get("id_business")?.setValue(e),this.mode()==="create"?this.createCategorySub=this.createCategoryService.createCategory(this.form).subscribe({next:t=>{},complete:()=>{this.categoryCreatedSignal.set(!0),this.createCategory.nativeElement.classList.add("hidden"),this.createCategorySub?.unsubscribe(),this.loaderService.deactivateInternalSignal(),this.toastr.success("Categor\xEDa creada exitosamente"),this.form.reset({name:"",description:"",isActive:!0})},error:t=>{console.error("Error en la creaci\xF3n de categor\xEDa:",t),this.loaderService.deactivateInternalSignal(),this.toastr.error(t.error.message),this.form.reset({name:"",description:"",isActive:!0})}}):this.updateCategorySub=this.createCategoryService.updateCategory(this.form,this.categoryId()).subscribe({next:t=>{this.createCategory.nativeElement.classList.add("hidden"),this.loaderService.deactivateInternalSignal(),this.toastr.success("Categor\xEDa actualizada exitosamente"),this.categoryCreatedSignal.set(!0),this.updateCategorySub?.unsubscribe(),this.form.reset({name:"",description:"",isActive:!0}),this.categoryId.set(NaN)},error:t=>{console.error("Error en la actualizaci\xF3n de categor\xEDa:",t),this.loaderService.deactivateInternalSignal(),this.toastr.error(t.error.message),this.form.reset({name:"",description:"",isActive:!0})}})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=pe({type:i,selectors:[["app-create-category"]],viewQuery:function(t,s){if(t&1&&Me(Rt,5),t&2){let a;Ee(a=Ne())&&(s.createCategory=a.first)}},inputs:{categoryCreatedSignal:"categoryCreatedSignal",categories:"categories",categoryId:"categoryId",mode:"mode",resetForm:"resetForm"},decls:42,vars:17,consts:[["createCategory",""],["id","createCategory","tabindex","-1",1,"absolute","hidden","justify-center","items-center","top-0","left-0","backdrop-blur-xs","w-full","h-full","z-10"],[1,"w-sm","md:w-md","lg:w-lg","h-fit","bg-color","rounded-xl","p-5","relative","animate-fadeIn"],["type","button","data-modal-hide","createCategory","aria-hidden","true",1,"absolute","cursor-pointer","top-3","end-2.5","text-gray-400","bg-transparent","hover:bg-gray-200","hover:text-gray-900","rounded-lg","text-sm","w-8","h-8","ms-auto","inline-flex","justify-center","items-center","dark:hover:bg-gray-600","dark:hover:text-white"],["type","button",1,"fa-solid","fa-close","cursor-pointer","text-xl"],[1,"sr-only"],[1,"h4","mb-2"],[1,"fa","fa-plus"],[1,"mt-5",3,"ngSubmit","formGroup"],[1,"mb-8","relative","grid","grid-cols-3","gap-2"],[1,"col-span-2"],["for","name",1,"label-behavior"],["type","text","id","name","formControlName","name","placeholder","Escribe el nombre de la categor\xEDa",1,"input-behavior",3,"ngClass"],[1,"text-red-500","text-sm","absolute"],["for","estado",1,"label-behavior"],["id","estado","type","text","formControlName","isActive",1,"input-behavior"],[3,"ngValue","selected"],[1,"fa","fa-check"],[3,"ngValue"],[1,"fa","fa-close"],[1,"mb-10","relative"],["for","description",1,"label-behavior"],["id","description","formControlName","description","rows","5","placeholder","Escribe la descripci\xF3n de la categor\xEDa",1,"input-behavior",3,"ngClass"],[1,"mb-3","flex","justify-between"],["type","button","data-modal-hide","createCategory",1,"button-cancel"],[1,"fa","fa-ban"],["type","submit",1,"button-create",3,"disabled"]],template:function(t,s){if(t&1){let a=De();L(0,"div",1,0)(2,"div",2)(3,"button",3),B(4,"span",4),L(5,"span",5),F(6,"Close modal"),P()(),L(7,"h4",6),B(8,"span",7),F(9),P(),B(10,"hr"),L(11,"form",8),me("ngSubmit",function(){return Ce(a),xe(s.onSubmitCategory())}),L(12,"div",9)(13,"div",10)(14,"label",11),F(15,"Nombre"),P(),B(16,"input",12),Fe(17,Ht,2,0,"p",13)(18,Yt,2,0,"p",13),P(),L(19,"div")(20,"label",14),F(21,"Estado"),P(),L(22,"select",15)(23,"option",16),B(24,"span",17),F(25," Activo"),P(),L(26,"option",18),B(27,"span",19),F(28," Inactivo"),P()()()(),L(29,"div",20)(30,"label",21),F(31,"Descripci\xF3n"),P(),B(32,"textarea",22),Fe(33,Ft,2,0,"p",13)(34,jt,2,0,"p",13),P(),L(35,"div",23)(36,"button",24),B(37,"span",25),F(38," Cancelar"),P(),L(39,"button",26),B(40,"span",17),F(41),P()()()()()}if(t&2){let a,n,o,r,l,d;W(9),je(" ",s.mode()==="create"?s.textModalCreate.title:s.textModalmodify.title,""),W(2),te("formGroup",s.form),W(5),te("ngClass",qe(13,Mt,((a=s.form.get("name"))==null?null:a.hasError("required"))&&((a=s.form.get("name"))==null?null:a.touched))),W(),be((n=s.form.get("name"))!=null&&n.hasError("required")&&((n=s.form.get("name"))!=null&&n.touched)?17:-1),W(),be((o=s.form.get("name"))!=null&&o.hasError("minlength")?18:-1),W(5),te("ngValue",!0)("selected",!0),W(3),te("ngValue",!1),W(6),te("ngClass",qe(15,Mt,((r=s.form.get("description"))==null?null:r.hasError("required"))&&((r=s.form.get("description"))==null?null:r.touched))),W(),be((l=s.form.get("description"))!=null&&l.hasError("required")&&((l=s.form.get("description"))!=null&&l.touched)?33:-1),W(),be((d=s.form.get("description"))!=null&&d.hasError("minlength")?34:-1),W(5),te("disabled",s.form.invalid),W(2),je(" ",s.mode()==="create"?s.textModalCreate.button:s.textModalmodify.button,"")}},dependencies:[Se,lt,xt,wt,pt,bt,vt,ct,gt,ht,ut,_t,mt,ft],encapsulation:2})};var qt=i=>Object.prototype.toString.call(i)==="[object Object]";var ze=(i,e)=>{let t=document.createElement(i);if(e&&typeof e=="object")for(let s in e)s==="html"?t.innerHTML=e[s]:t.setAttribute(s,e[s]);return t},_e=i=>["#text","#comment"].includes(i.nodeName)?i.data:i.childNodes?i.childNodes.map(e=>_e(e)).join(""):"",he=i=>{if(i==null)return"";if(i.hasOwnProperty("text")||i.hasOwnProperty("data")){let e=i;return e.text??he(e.data)}return i.hasOwnProperty("nodeName")?_e(i):String(i)};var Nt=function(i,e){let t=0,s=0;for(;t<i+1;)e[s].hidden||(t+=1),s+=1;return s-1},Ot=function(i){let e={};if(i)for(let t of i)e[t.name]=t.value;return e},re=i=>i?i.trim().split(" ").map(e=>`.${e}`).join(""):null,Be=(i,e)=>!e?.split(" ").some(s=>!i.classList.contains(s)),K=(i,e)=>i?e?`${i} ${e}`:i:e||"",Ut=function(i,e=300){let t;return(...s)=>{clearTimeout(t),t=window.setTimeout(()=>i(),e)}},Ge=function(){return Ge=Object.assign||function(i){for(var e,t=arguments,s=1,a=arguments.length;s<a;s++)for(var n in e=t[s])Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);return i},Ge.apply(this,arguments)};function Ae(i,e,t){if(t||arguments.length===2)for(var s,a=0,n=e.length;a<n;a++)!s&&a in e||(s||(s=Array.prototype.slice.call(e,0,a)),s[a]=e[a]);return i.concat(s||Array.prototype.slice.call(e))}var I=function(){function i(e){e===void 0&&(e={});var t=this;Object.entries(e).forEach(function(s){var a=s[0],n=s[1];return t[a]=n})}return i.prototype.toString=function(){return JSON.stringify(this)},i.prototype.setValue=function(e,t){return this[e]=t,this},i}();function Y(i){for(var e=arguments,t=[],s=1;s<arguments.length;s++)t[s-1]=e[s];return i!=null&&t.some(function(a){var n,o;return typeof((o=(n=i?.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||o===void 0?void 0:o[a])=="function"&&i instanceof i.ownerDocument.defaultView[a]})}function Xe(i,e,t){var s;return i.nodeName==="#text"?s=t.document.createTextNode(i.data):i.nodeName==="#comment"?s=t.document.createComment(i.data):(e?(s=t.document.createElementNS("http://www.w3.org/2000/svg",i.nodeName),i.nodeName==="foreignObject"&&(e=!1)):i.nodeName.toLowerCase()==="svg"?(s=t.document.createElementNS("http://www.w3.org/2000/svg","svg"),e=!0):s=t.document.createElement(i.nodeName),i.attributes&&Object.entries(i.attributes).forEach(function(a){var n=a[0],o=a[1];return s.setAttribute(n,o)}),i.childNodes&&i.childNodes.forEach(function(a){return s.appendChild(Xe(a,e,t))}),t.valueDiffing&&(i.value&&Y(s,"HTMLButtonElement","HTMLDataElement","HTMLInputElement","HTMLLIElement","HTMLMeterElement","HTMLOptionElement","HTMLProgressElement","HTMLParamElement")&&(s.value=i.value),i.checked&&Y(s,"HTMLInputElement")&&(s.checked=i.checked),i.selected&&Y(s,"HTMLOptionElement")&&(s.selected=i.selected))),s}var We=function(i,e){for(e=e.slice();e.length>0;){var t=e.splice(0,1)[0];i=i.childNodes[t]}return i};function se(i,e,t){var s,a,n,o=e[t._const.action],r=e[t._const.route];[t._const.addElement,t._const.addTextElement].includes(o)||(s=We(i,r));var l={diff:e,node:s};if(t.preDiffApply(l))return!0;switch(o){case t._const.addAttribute:if(!s||!Y(s,"Element"))return!1;s.setAttribute(e[t._const.name],e[t._const.value]);break;case t._const.modifyAttribute:if(!s||!Y(s,"Element"))return!1;s.setAttribute(e[t._const.name],e[t._const.newValue]),Y(s,"HTMLInputElement")&&e[t._const.name]==="value"&&(s.value=e[t._const.newValue]);break;case t._const.removeAttribute:if(!s||!Y(s,"Element"))return!1;s.removeAttribute(e[t._const.name]);break;case t._const.modifyTextElement:if(!s||!Y(s,"Text"))return!1;t.textDiff(s,s.data,e[t._const.oldValue],e[t._const.newValue]),Y(s.parentNode,"HTMLTextAreaElement")&&(s.parentNode.value=e[t._const.newValue]);break;case t._const.modifyValue:if(!s||s.value===void 0)return!1;s.value=e[t._const.newValue];break;case t._const.modifyComment:if(!s||!Y(s,"Comment"))return!1;t.textDiff(s,s.data,e[t._const.oldValue],e[t._const.newValue]);break;case t._const.modifyChecked:if(!s||s.checked===void 0)return!1;s.checked=e[t._const.newValue];break;case t._const.modifySelected:if(!s||s.selected===void 0)return!1;s.selected=e[t._const.newValue];break;case t._const.replaceElement:var d=e[t._const.newValue].nodeName.toLowerCase()==="svg"||s.parentNode.namespaceURI==="http://www.w3.org/2000/svg";s.parentNode.replaceChild(Xe(e[t._const.newValue],d,t),s);break;case t._const.relocateGroup:Ae([],new Array(e[t._const.groupLength]),!0).map(function(){return s.removeChild(s.childNodes[e[t._const.from]])}).forEach(function(h,p){p===0&&(n=s.childNodes[e[t._const.to]]),s.insertBefore(h,n||null)});break;case t._const.removeElement:s.parentNode.removeChild(s);break;case t._const.addElement:var u=(m=r.slice()).splice(m.length-1,1)[0];if(!Y(s=We(i,m),"Element"))return!1;s.insertBefore(Xe(e[t._const.element],s.namespaceURI==="http://www.w3.org/2000/svg",t),s.childNodes[u]||null);break;case t._const.removeTextElement:if(!s||s.nodeType!==3)return!1;var f=s.parentNode;f.removeChild(s),Y(f,"HTMLTextAreaElement")&&(f.value="");break;case t._const.addTextElement:var m;if(u=(m=r.slice()).splice(m.length-1,1)[0],a=t.document.createTextNode(e[t._const.value]),!(s=We(i,m)).childNodes)return!1;s.insertBefore(a,s.childNodes[u]||null),Y(s.parentNode,"HTMLTextAreaElement")&&(s.parentNode.value=e[t._const.value]);break;default:console.log("unknown action")}return t.postDiffApply({diff:l.diff,node:l.node,newNode:a}),!0}function Qe(i,e,t){var s=i[e];i[e]=i[t],i[t]=s}function zt(i,e,t){(e=e.slice()).reverse(),e.forEach(function(s){(function(a,n,o){switch(n[o._const.action]){case o._const.addAttribute:n[o._const.action]=o._const.removeAttribute,se(a,n,o);break;case o._const.modifyAttribute:Qe(n,o._const.oldValue,o._const.newValue),se(a,n,o);break;case o._const.removeAttribute:n[o._const.action]=o._const.addAttribute,se(a,n,o);break;case o._const.modifyTextElement:case o._const.modifyValue:case o._const.modifyComment:case o._const.modifyChecked:case o._const.modifySelected:case o._const.replaceElement:Qe(n,o._const.oldValue,o._const.newValue),se(a,n,o);break;case o._const.relocateGroup:Qe(n,o._const.from,o._const.to),se(a,n,o);break;case o._const.removeElement:n[o._const.action]=o._const.addElement,se(a,n,o);break;case o._const.addElement:n[o._const.action]=o._const.removeElement,se(a,n,o);break;case o._const.removeTextElement:n[o._const.action]=o._const.addTextElement,se(a,n,o);break;case o._const.addTextElement:n[o._const.action]=o._const.removeTextElement,se(a,n,o);break;default:console.log("unknown action")}})(i,s,t)})}var Ze=function(i){var e=[];return e.push(i.nodeName),i.nodeName!=="#text"&&i.nodeName!=="#comment"&&i.attributes&&(i.attributes.class&&e.push("".concat(i.nodeName,".").concat(i.attributes.class.replace(/ /g,"."))),i.attributes.id&&e.push("".concat(i.nodeName,"#").concat(i.attributes.id))),e},St=function(i){var e={},t={};return i.forEach(function(s){Ze(s).forEach(function(a){var n=a in e;n||a in t?n&&(delete e[a],t[a]=!0):e[a]=!0})}),e},At=function(i,e){var t=St(i),s=St(e),a={};return Object.keys(t).forEach(function(n){s[n]&&(a[n]=!0)}),a},Lt=function(i){return delete i.outerDone,delete i.innerDone,delete i.valueDone,!i.childNodes||i.childNodes.every(Lt)},q=function(i){if(Object.prototype.hasOwnProperty.call(i,"data"))return{nodeName:i.nodeName==="#text"?"#text":"#comment",data:i.data};var e={nodeName:i.nodeName};return Object.prototype.hasOwnProperty.call(i,"attributes")&&(e.attributes=Ge({},i.attributes)),Object.prototype.hasOwnProperty.call(i,"checked")&&(e.checked=i.checked),Object.prototype.hasOwnProperty.call(i,"value")&&(e.value=i.value),Object.prototype.hasOwnProperty.call(i,"selected")&&(e.selected=i.selected),Object.prototype.hasOwnProperty.call(i,"childNodes")&&(e.childNodes=i.childNodes.map(function(t){return q(t)})),e},Ke=function(i,e){if(!["nodeName","value","checked","selected","data"].every(function(a){return i[a]===e[a]}))return!1;if(Object.prototype.hasOwnProperty.call(i,"data"))return!0;if(!!i.attributes!=!!e.attributes||!!i.childNodes!=!!e.childNodes)return!1;if(i.attributes){var t=Object.keys(i.attributes),s=Object.keys(e.attributes);if(t.length!==s.length||!t.every(function(a){return i.attributes[a]===e.attributes[a]}))return!1}return!(i.childNodes&&(i.childNodes.length!==e.childNodes.length||!i.childNodes.every(function(a,n){return Ke(a,e.childNodes[n])})))},it=function(i,e,t,s,a){if(a===void 0&&(a=!1),!i||!e||i.nodeName!==e.nodeName)return!1;if(["#text","#comment"].includes(i.nodeName))return!!a||i.data===e.data;if(i.nodeName in t)return!0;if(i.attributes&&e.attributes){if(i.attributes.id){if(i.attributes.id!==e.attributes.id)return!1;if("".concat(i.nodeName,"#").concat(i.attributes.id)in t)return!0}if(i.attributes.class&&i.attributes.class===e.attributes.class&&"".concat(i.nodeName,".").concat(i.attributes.class.replace(/ /g,"."))in t)return!0}if(s)return!0;var n=i.childNodes?i.childNodes.slice().reverse():[],o=e.childNodes?e.childNodes.slice().reverse():[];if(n.length!==o.length)return!1;if(a)return n.every(function(l,d){return l.nodeName===o[d].nodeName});var r=At(n,o);return n.every(function(l,d){return it(l,o[d],r,!0,!0)})},Le=function(i,e){return Ae([],new Array(i),!0).map(function(){return e})},Bt=function(i,e){for(var t=i.childNodes?i.childNodes:[],s=e.childNodes?e.childNodes:[],a=Le(t.length,!1),n=Le(s.length,!1),o=[],r=function(){return arguments[1]},l=!1,d=function(){var u=function(f,m,h,p){var C=0,x=[],O=f.length,c=m.length,_=Ae([],new Array(O+1),!0).map(function(){return[]}),$=At(f,m),V=O===c;V&&f.some(function(k,R){var y=Ze(k),b=Ze(m[R]);return y.length!==b.length?(V=!1,!0):(y.some(function(g,w){if(g!==b[w])return V=!1,!0}),!V||void 0)});for(var S=0;S<O;S++)for(var A=f[S],E=0;E<c;E++){var D=m[E];h[S]||p[E]||!it(A,D,$,V)?_[S+1][E+1]=0:(_[S+1][E+1]=_[S][E]?_[S][E]+1:1,_[S+1][E+1]>=C&&(C=_[S+1][E+1],x=[S+1,E+1]))}return C!==0&&{oldValue:x[0]-C,newValue:x[1]-C,length:C}}(t,s,a,n);u?(o.push(u),Ae([],new Array(u.length),!0).map(r).forEach(function(f){return function(m,h,p,C){m[p.oldValue+C]=!0,h[p.newValue+C]=!0}(a,n,u,f)})):l=!0};!l;)d();return i.subsets=o,i.subsetsAge=100,o},Wt=function(){function i(){this.list=[]}return i.prototype.add=function(e){var t;(t=this.list).push.apply(t,e)},i.prototype.forEach=function(e){this.list.forEach(function(t){return e(t)})},i}();function Je(i,e){var t,s,a=i;for(e=e.slice();e.length>0;)s=e.splice(0,1)[0],t=a,a=a.childNodes?a.childNodes[s]:void 0;return{node:a,parentNode:t,nodeIndex:s}}function Qt(i,e,t){return e.forEach(function(s){(function(a,n,o){var r,l,d,u;if(![o._const.addElement,o._const.addTextElement].includes(n[o._const.action])){var f=Je(a,n[o._const.route]);l=f.node,d=f.parentNode,u=f.nodeIndex}var m,h,p=[],C={diff:n,node:l};if(o.preVirtualDiffApply(C))return!0;switch(n[o._const.action]){case o._const.addAttribute:l.attributes||(l.attributes={}),l.attributes[n[o._const.name]]=n[o._const.value],n[o._const.name]==="checked"?l.checked=!0:n[o._const.name]==="selected"?l.selected=!0:l.nodeName==="INPUT"&&n[o._const.name]==="value"&&(l.value=n[o._const.value]);break;case o._const.modifyAttribute:l.attributes[n[o._const.name]]=n[o._const.newValue];break;case o._const.removeAttribute:delete l.attributes[n[o._const.name]],Object.keys(l.attributes).length===0&&delete l.attributes,n[o._const.name]==="checked"?l.checked=!1:n[o._const.name]==="selected"?delete l.selected:l.nodeName==="INPUT"&&n[o._const.name]==="value"&&delete l.value;break;case o._const.modifyTextElement:l.data=n[o._const.newValue],d.nodeName==="TEXTAREA"&&(d.value=n[o._const.newValue]);break;case o._const.modifyValue:l.value=n[o._const.newValue];break;case o._const.modifyComment:l.data=n[o._const.newValue];break;case o._const.modifyChecked:l.checked=n[o._const.newValue];break;case o._const.modifySelected:l.selected=n[o._const.newValue];break;case o._const.replaceElement:m=q(n[o._const.newValue]),d.childNodes[u]=m;break;case o._const.relocateGroup:l.childNodes.splice(n[o._const.from],n[o._const.groupLength]).reverse().forEach(function(c){return l.childNodes.splice(n[o._const.to],0,c)}),l.subsets&&l.subsets.forEach(function(c){if(n[o._const.from]<n[o._const.to]&&c.oldValue<=n[o._const.to]&&c.oldValue>n[o._const.from])c.oldValue-=n[o._const.groupLength],(_=c.oldValue+c.length-n[o._const.to])>0&&(p.push({oldValue:n[o._const.to]+n[o._const.groupLength],newValue:c.newValue+c.length-_,length:_}),c.length-=_);else if(n[o._const.from]>n[o._const.to]&&c.oldValue>n[o._const.to]&&c.oldValue<n[o._const.from]){var _;c.oldValue+=n[o._const.groupLength],(_=c.oldValue+c.length-n[o._const.to])>0&&(p.push({oldValue:n[o._const.to]+n[o._const.groupLength],newValue:c.newValue+c.length-_,length:_}),c.length-=_)}else c.oldValue===n[o._const.from]&&(c.oldValue=n[o._const.to])});break;case o._const.removeElement:d.childNodes.splice(u,1),d.subsets&&d.subsets.forEach(function(c){c.oldValue>u?c.oldValue-=1:c.oldValue===u?c.delete=!0:c.oldValue<u&&c.oldValue+c.length>u&&(c.oldValue+c.length-1===u?c.length--:(p.push({newValue:c.newValue+u-c.oldValue,oldValue:u,length:c.length-u+c.oldValue-1}),c.length=u-c.oldValue))}),l=d;break;case o._const.addElement:var x=(h=n[o._const.route].slice()).splice(h.length-1,1)[0];l=(r=Je(a,h))===null||r===void 0?void 0:r.node,m=q(n[o._const.element]),l.childNodes||(l.childNodes=[]),x>=l.childNodes.length?l.childNodes.push(m):l.childNodes.splice(x,0,m),l.subsets&&l.subsets.forEach(function(c){if(c.oldValue>=x)c.oldValue+=1;else if(c.oldValue<x&&c.oldValue+c.length>x){var _=c.oldValue+c.length-x;p.push({newValue:c.newValue+c.length-_,oldValue:x+1,length:_}),c.length-=_}});break;case o._const.removeTextElement:d.childNodes.splice(u,1),d.nodeName==="TEXTAREA"&&delete d.value,d.subsets&&d.subsets.forEach(function(c){c.oldValue>u?c.oldValue-=1:c.oldValue===u?c.delete=!0:c.oldValue<u&&c.oldValue+c.length>u&&(c.oldValue+c.length-1===u?c.length--:(p.push({newValue:c.newValue+u-c.oldValue,oldValue:u,length:c.length-u+c.oldValue-1}),c.length=u-c.oldValue))}),l=d;break;case o._const.addTextElement:var O=(h=n[o._const.route].slice()).splice(h.length-1,1)[0];m={nodeName:"#text",data:n[o._const.value]},(l=Je(a,h).node).childNodes||(l.childNodes=[]),O>=l.childNodes.length?l.childNodes.push(m):l.childNodes.splice(O,0,m),l.nodeName==="TEXTAREA"&&(l.value=n[o._const.newValue]),l.subsets&&l.subsets.forEach(function(c){if(c.oldValue>=O&&(c.oldValue+=1),c.oldValue<O&&c.oldValue+c.length>O){var _=c.oldValue+c.length-O;p.push({newValue:c.newValue+c.length-_,oldValue:O+1,length:_}),c.length-=_}});break;default:console.log("unknown action")}l.subsets&&(l.subsets=l.subsets.filter(function(c){return!c.delete&&c.oldValue!==c.newValue}),p.length&&(l.subsets=l.subsets.concat(p))),o.postVirtualDiffApply({node:C.node,diff:C.diff,newNode:m})})(i,s,t)}),!0}function le(i,e){e===void 0&&(e={valueDiffing:!0});var t={nodeName:i.nodeName};return Y(i,"Text","Comment")?t.data=i.data:(i.attributes&&i.attributes.length>0&&(t.attributes={},Array.prototype.slice.call(i.attributes).forEach(function(s){return t.attributes[s.name]=s.value})),i.childNodes&&i.childNodes.length>0&&(t.childNodes=[],Array.prototype.slice.call(i.childNodes).forEach(function(s){return t.childNodes.push(le(s,e))})),e.valueDiffing&&(Y(i,"HTMLTextAreaElement")&&(t.value=i.value),Y(i,"HTMLInputElement")&&["radio","checkbox"].includes(i.type.toLowerCase())&&i.checked!==void 0?t.checked=i.checked:Y(i,"HTMLButtonElement","HTMLDataElement","HTMLInputElement","HTMLLIElement","HTMLMeterElement","HTMLOptionElement","HTMLProgressElement","HTMLParamElement")&&(t.value=i.value),Y(i,"HTMLOptionElement")&&(t.selected=i.selected))),t}var Jt=/<\s*\/*[a-zA-Z:_][a-zA-Z0-9:_\-.]*\s*(?:"[^"]*"['"]*|'[^']*'['"]*|[^'"/>])*\/*\s*>|<!--(?:.|\n|\r)*?-->/g,Gt=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function Vt(i){return i.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}var Xt={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuItem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},$t=function(i,e){var t={nodeName:"",attributes:{}},s=!1,a=i.match(/<\/?([^\s]+?)[/\s>]/);if(a&&(t.nodeName=e||a[1]==="svg"?a[1]:a[1].toUpperCase(),(Xt[a[1]]||i.charAt(i.length-2)==="/")&&(s=!0),t.nodeName.startsWith("!--"))){var n=i.indexOf("-->");return{type:"comment",node:{nodeName:"#comment",data:n!==-1?i.slice(4,n):""},voidElement:s}}for(var o=new RegExp(Gt),r=null,l=!1;!l;)if((r=o.exec(i))===null)l=!0;else if(r[0].trim())if(r[1]){var d=r[1].trim(),u=[d,""];d.indexOf("=")>-1&&(u=d.split("=")),t.attributes[u[0]]=u[1],o.lastIndex--}else r[2]&&(t.attributes[r[2]]=r[3].trim().substring(1,r[3].length-1));return{type:"tag",node:t,voidElement:s}},de=function(i,e){e===void 0&&(e={valueDiffing:!0,caseSensitive:!1});var t,s=[],a=-1,n=[],o=!1;if(i.indexOf("<")!==0){var r=i.indexOf("<");s.push({nodeName:"#text",data:r===-1?i:i.substring(0,r)})}return i.replace(Jt,function(l,d){var u=l.charAt(1)!=="/",f=l.startsWith("<!--"),m=d+l.length,h=i.charAt(m);if(f){var p=$t(l,e.caseSensitive).node;if(a<0)return s.push(p),"";var C=n[a];return C&&p.nodeName&&(C.node.childNodes||(C.node.childNodes=[]),C.node.childNodes.push(p)),""}if(u){if((t=$t(l,e.caseSensitive||o)).node.nodeName==="svg"&&(o=!0),a++,!t.voidElement&&h&&h!=="<"){t.node.childNodes||(t.node.childNodes=[]);var x=Vt(i.slice(m,i.indexOf("<",m)));t.node.childNodes.push({nodeName:"#text",data:x}),e.valueDiffing&&t.node.nodeName==="TEXTAREA"&&(t.node.value=x)}a===0&&t.node.nodeName&&s.push(t.node);var O=n[a-1];O&&t.node.nodeName&&(O.node.childNodes||(O.node.childNodes=[]),O.node.childNodes.push(t.node)),n[a]=t}if((!u||t.voidElement)&&(a>-1&&(t.voidElement||e.caseSensitive&&t.node.nodeName===l.slice(2,-1)||!e.caseSensitive&&t.node.nodeName.toUpperCase()===l.slice(2,-1).toUpperCase())&&--a>-1&&(t.node.nodeName==="svg"&&(o=!1),t=n[a]),h!=="<"&&h)){var c=a===-1?s:n[a].node.childNodes||[],_=i.indexOf("<",m);x=Vt(i.slice(m,_===-1?void 0:_)),c.push({nodeName:"#text",data:x})}return""}),s[0]},Zt=function(){function i(e,t,s){this.options=s,this.t1=typeof Element<"u"&&Y(e,"Element")?le(e,this.options):typeof e=="string"?de(e,this.options):JSON.parse(JSON.stringify(e)),this.t2=typeof Element<"u"&&Y(t,"Element")?le(t,this.options):typeof t=="string"?de(t,this.options):JSON.parse(JSON.stringify(t)),this.diffcount=0,this.foundAll=!1,this.debug&&(this.t1Orig=typeof Element<"u"&&Y(e,"Element")?le(e,this.options):typeof e=="string"?de(e,this.options):JSON.parse(JSON.stringify(e)),this.t2Orig=typeof Element<"u"&&Y(t,"Element")?le(t,this.options):typeof t=="string"?de(t,this.options):JSON.parse(JSON.stringify(t))),this.tracker=new Wt}return i.prototype.init=function(){return this.findDiffs(this.t1,this.t2)},i.prototype.findDiffs=function(e,t){var s;do{if(this.options.debug&&(this.diffcount+=1,this.diffcount>this.options.diffcap))throw new Error("surpassed diffcap:".concat(JSON.stringify(this.t1Orig)," -> ").concat(JSON.stringify(this.t2Orig)));(s=this.findNextDiff(e,t,[])).length===0&&(Ke(e,t)||(this.foundAll?console.error("Could not find remaining diffs!"):(this.foundAll=!0,Lt(e),s=this.findNextDiff(e,t,[])))),s.length>0&&(this.foundAll=!1,this.tracker.add(s),Qt(e,s,this.options))}while(s.length>0);return this.tracker.list},i.prototype.findNextDiff=function(e,t,s){var a,n;if(this.options.maxDepth&&s.length>this.options.maxDepth)return[];if(!e.outerDone){if(a=this.findOuterDiff(e,t,s),this.options.filterOuterDiff&&(n=this.options.filterOuterDiff(e,t,a))&&(a=n),a.length>0)return e.outerDone=!0,a;e.outerDone=!0}if(Object.prototype.hasOwnProperty.call(e,"data"))return[];if(!e.innerDone){if((a=this.findInnerDiff(e,t,s)).length>0)return a;e.innerDone=!0}if(this.options.valueDiffing&&!e.valueDone){if((a=this.findValueDiff(e,t,s)).length>0)return e.valueDone=!0,a;e.valueDone=!0}return[]},i.prototype.findOuterDiff=function(e,t,s){var a,n,o,r,l,d,u=[];if(e.nodeName!==t.nodeName){if(!s.length)throw new Error("Top level nodes have to be of the same kind.");return[new I().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,q(e)).setValue(this.options._const.newValue,q(t)).setValue(this.options._const.route,s)]}if(s.length&&this.options.diffcap<Math.abs((e.childNodes||[]).length-(t.childNodes||[]).length))return[new I().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,q(e)).setValue(this.options._const.newValue,q(t)).setValue(this.options._const.route,s)];if(Object.prototype.hasOwnProperty.call(e,"data")&&e.data!==t.data)return e.nodeName==="#text"?[new I().setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,s).setValue(this.options._const.oldValue,e.data).setValue(this.options._const.newValue,t.data)]:[new I().setValue(this.options._const.action,this.options._const.modifyComment).setValue(this.options._const.route,s).setValue(this.options._const.oldValue,e.data).setValue(this.options._const.newValue,t.data)];for(n=e.attributes?Object.keys(e.attributes).sort():[],o=t.attributes?Object.keys(t.attributes).sort():[],r=n.length,d=0;d<r;d++)a=n[d],(l=o.indexOf(a))===-1?u.push(new I().setValue(this.options._const.action,this.options._const.removeAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,a).setValue(this.options._const.value,e.attributes[a])):(o.splice(l,1),e.attributes[a]!==t.attributes[a]&&u.push(new I().setValue(this.options._const.action,this.options._const.modifyAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,a).setValue(this.options._const.oldValue,e.attributes[a]).setValue(this.options._const.newValue,t.attributes[a])));for(r=o.length,d=0;d<r;d++)a=o[d],u.push(new I().setValue(this.options._const.action,this.options._const.addAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,a).setValue(this.options._const.value,t.attributes[a]));return u},i.prototype.findInnerDiff=function(e,t,s){var a=e.childNodes?e.childNodes.slice():[],n=t.childNodes?t.childNodes.slice():[],o=Math.max(a.length,n.length),r=Math.abs(a.length-n.length),l=[],d=0;if(!this.options.maxChildCount||o<this.options.maxChildCount){var u=!!(e.subsets&&e.subsetsAge--),f=u?e.subsets:e.childNodes&&t.childNodes?Bt(e,t):[];if(f.length>0&&(l=this.attemptGroupRelocation(e,t,f,s,u)).length>0)return l}for(var m=0;m<o;m+=1){var h=a[m],p=n[m];r&&(h&&!p?h.nodeName==="#text"?(l.push(new I().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.value,h.data)),d-=1):(l.push(new I().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.element,q(h))),d-=1):p&&!h&&(p.nodeName==="#text"?l.push(new I().setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.value,p.data)):l.push(new I().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.element,q(p))))),h&&p&&(!this.options.maxChildCount||o<this.options.maxChildCount?l=l.concat(this.findNextDiff(h,p,s.concat(d))):Ke(h,p)||(a.length>n.length?(h.nodeName==="#text"?l.push(new I().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.value,h.data)):l.push(new I().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.element,q(h)).setValue(this.options._const.route,s.concat(d))),a.splice(m,1),m-=1,d-=1,r-=1):a.length<n.length?(l=l.concat([new I().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.element,q(p)).setValue(this.options._const.route,s.concat(d))]),a.splice(m,0,q(p)),r-=1):l=l.concat([new I().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,q(h)).setValue(this.options._const.newValue,q(p)).setValue(this.options._const.route,s.concat(d))]))),d+=1}return e.innerDone=!0,l},i.prototype.attemptGroupRelocation=function(e,t,s,a,n){for(var o,r,l,d,u,f=function(S,A,E){var D=S.childNodes?Le(S.childNodes.length,!0):[],k=A.childNodes?Le(A.childNodes.length,!0):[],R=0;return E.forEach(function(y){for(var b=y.oldValue+y.length,g=y.newValue+y.length,w=y.oldValue;w<b;w+=1)D[w]=R;for(w=y.newValue;w<g;w+=1)k[w]=R;R+=1}),{gaps1:D,gaps2:k}}(e,t,s),m=f.gaps1,h=f.gaps2,p=e.childNodes.slice(),C=t.childNodes.slice(),x=Math.min(m.length,h.length),O=[],c=0,_=0;c<x;_+=1,c+=1)if(!n||m[c]!==!0&&h[c]!==!0){if(m[_]===!0)if((d=p[_]).nodeName==="#text")if(C[c].nodeName==="#text"){if(d.data!==C[c].data){for(var $=_;p.length>$+1&&p[$+1].nodeName==="#text";)if($+=1,C[c].data===p[$].data){u=!0;break}u||O.push(new I().setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,a.concat(_)).setValue(this.options._const.oldValue,d.data).setValue(this.options._const.newValue,C[c].data))}}else O.push(new I().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,a.concat(_)).setValue(this.options._const.value,d.data)),m.splice(_,1),p.splice(_,1),x=Math.min(m.length,h.length),_-=1,c-=1;else h[c]===!0?O.push(new I().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,q(d)).setValue(this.options._const.newValue,q(C[c])).setValue(this.options._const.route,a.concat(_))):(O.push(new I().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,a.concat(_)).setValue(this.options._const.element,q(d))),m.splice(_,1),p.splice(_,1),x=Math.min(m.length,h.length),_-=1,c-=1);else if(h[c]===!0)(d=C[c]).nodeName==="#text"?(O.push(new I().setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,a.concat(_)).setValue(this.options._const.value,d.data)),m.splice(_,0,!0),p.splice(_,0,{nodeName:"#text",data:d.data}),x=Math.min(m.length,h.length)):(O.push(new I().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,a.concat(_)).setValue(this.options._const.element,q(d))),m.splice(_,0,!0),p.splice(_,0,q(d)),x=Math.min(m.length,h.length));else if(m[_]!==h[c]){if(O.length>0)return O;if(l=s[m[_]],(r=Math.min(l.newValue,p.length-l.length))!==l.oldValue){o=!1;for(var V=0;V<l.length;V+=1)it(p[r+V],p[l.oldValue+V],{},!1,!0)||(o=!0);if(o)return[new I().setValue(this.options._const.action,this.options._const.relocateGroup).setValue(this.options._const.groupLength,l.length).setValue(this.options._const.from,l.oldValue).setValue(this.options._const.to,r).setValue(this.options._const.route,a)]}}}return O},i.prototype.findValueDiff=function(e,t,s){var a=[];return e.selected!==t.selected&&a.push(new I().setValue(this.options._const.action,this.options._const.modifySelected).setValue(this.options._const.oldValue,e.selected).setValue(this.options._const.newValue,t.selected).setValue(this.options._const.route,s)),(e.value||t.value)&&e.value!==t.value&&e.nodeName!=="OPTION"&&a.push(new I().setValue(this.options._const.action,this.options._const.modifyValue).setValue(this.options._const.oldValue,e.value||"").setValue(this.options._const.newValue,t.value||"").setValue(this.options._const.route,s)),e.checked!==t.checked&&a.push(new I().setValue(this.options._const.action,this.options._const.modifyChecked).setValue(this.options._const.oldValue,e.checked).setValue(this.options._const.newValue,t.checked).setValue(this.options._const.route,s)),a},i}(),Kt={debug:!1,diffcap:10,maxDepth:!1,maxChildCount:50,valueDiffing:!0,textDiff:function(i,e,t,s){i.data=s},preVirtualDiffApply:function(){},postVirtualDiffApply:function(){},preDiffApply:function(){},postDiffApply:function(){},filterOuterDiff:null,compress:!1,_const:!1,document:!(typeof window>"u"||!window.document)&&window.document,components:[]},es=function(){function i(e){if(e===void 0&&(e={}),Object.entries(Kt).forEach(function(a){var n=a[0],o=a[1];Object.prototype.hasOwnProperty.call(e,n)||(e[n]=o)}),!e._const){var t=["addAttribute","modifyAttribute","removeAttribute","modifyTextElement","relocateGroup","removeElement","addElement","removeTextElement","addTextElement","replaceElement","modifyValue","modifyChecked","modifySelected","modifyComment","action","route","oldValue","newValue","element","group","groupLength","from","to","name","value","data","attributes","nodeName","childNodes","checked","selected"],s={};e.compress?t.forEach(function(a,n){return s[a]=n}):t.forEach(function(a){return s[a]=a}),e._const=s}this.options=e}return i.prototype.apply=function(e,t){return function(s,a,n){return a.every(function(o){return se(s,o,n)})}(e,t,this.options)},i.prototype.undo=function(e,t){return zt(e,t,this.options)},i.prototype.diff=function(e,t){return new Zt(e,t,this.options).init()},i}(),et=(i,e,t,{classes:s,format:a,hiddenHeader:n,sortable:o,scrollY:r,type:l},{noColumnWidths:d,unhideHeader:u})=>({nodeName:"TR",childNodes:i.map((f,m)=>{let h=e[m]||{type:l,format:a,sortable:!0,searchable:!0};if(h.hidden)return;let p=f.attributes?Q({},f.attributes):{};if(h.sortable&&o&&(!r.length||u)&&(h.filter?p["data-filterable"]="true":p["data-sortable"]="true"),h.headerClass&&(p.class=K(p.class,h.headerClass)),t.sort&&t.sort.column===m){let x=t.sort.dir==="asc"?s.ascending:s.descending;p.class=K(p.class,x),p["aria-sort"]=t.sort.dir==="asc"?"ascending":"descending"}else t.filters[m]&&(p.class=K(p.class,s.filterActive));if(t.widths[m]&&!d){let x=`width: ${t.widths[m]}%;`;p.style=K(p.style,x)}if(r.length&&!u){let x="padding-bottom: 0;padding-top: 0;border: 0;";p.style=K(p.style,x)}let C=f.type==="html"?f.data:[{nodeName:"#text",data:f.text??String(f.data)}];return{nodeName:"TH",attributes:p,childNodes:!n&&!r.length||u?h.sortable&&o?[{nodeName:"BUTTON",attributes:{class:h.filter?s.filter:s.sorter},childNodes:C}]:C:[{nodeName:"#text",data:""}]}}).filter(f=>f)}),kt=(i,e,t,s,a,n,{classes:o,hiddenHeader:r,header:l,footer:d,format:u,sortable:f,scrollY:m,type:h,rowRender:p,tabIndex:C},{noColumnWidths:x,unhideHeader:O,renderHeader:c},_,$)=>{let V={nodeName:"TABLE",attributes:Q({},i),childNodes:[{nodeName:"TBODY",childNodes:t.map(({row:S,index:A})=>{let E={nodeName:"TR",attributes:Ye(Q({},S.attributes),{"data-index":String(A)}),childNodes:S.cells.map((D,k)=>{let R=s[k]||{type:h,format:u,sortable:!0,searchable:!0};if(R.hidden)return;let y={nodeName:"TD",attributes:D.attributes?Q({},D.attributes):{},childNodes:R.type==="html"?D.data:[{nodeName:"#text",data:he(D)}]};if(l||d||!a.widths[k]||x||(y.attributes.style=K(y.attributes.style,`width: ${a.widths[k]}%;`)),R.cellClass&&(y.attributes.class=K(y.attributes.class,R.cellClass)),R.render){let b=R.render(D.data,y,A,k);if(b){if(typeof b!="string")return b;{let g=de(`<td>${b}</td>`);g.childNodes.length===1&&["#text","#comment"].includes(g.childNodes[0].nodeName)?y.childNodes[0].data=b:y.childNodes=g.childNodes}}}return y}).filter(D=>D)};if(A===n&&(E.attributes.class=K(E.attributes.class,o.cursor)),p){let D=p(S,E,A);if(D){if(typeof D!="string")return D;{let k=de(`<tr>${D}</tr>`);!k.childNodes||k.childNodes.length===1&&["#text","#comment"].includes(k.childNodes[0].nodeName)?E.childNodes[0].data=D:E.childNodes=k.childNodes}}}return E})}]};if(V.attributes.class=K(V.attributes.class,o.table),l||d||c){let S=et(e,s,a,{classes:o,hiddenHeader:r,sortable:f,scrollY:m},{noColumnWidths:x,unhideHeader:O});if(l||c){let A={nodeName:"THEAD",childNodes:[S]};!m.length&&!r||O||(A.attributes={style:"height: 0px;"}),V.childNodes.unshift(A)}if(d){let A={nodeName:"TFOOT",childNodes:[l?structuredClone(S):S]};!m.length&&!r||O||(A.attributes={style:"height: 0px;"}),V.childNodes.push(A)}}return _.forEach(S=>V.childNodes.push(S)),$.forEach(S=>V.childNodes.push(S)),C!==!1&&(V.attributes.tabindex=String(C)),V};function Pt(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var ts={exports:{}},ye=Pt(ts.exports=function(){var i=1e3,e=6e4,t=36e5,s="millisecond",a="second",n="minute",o="hour",r="day",l="week",d="month",u="quarter",f="year",m="date",h="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,C=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,x={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(y){var b=["th","st","nd","rd"],g=y%100;return"["+y+(b[(g-20)%10]||b[g]||b[0])+"]"}},O=function(y,b,g){var w=String(y);return!w||w.length>=b?y:""+Array(b+1-w.length).join(g)+y},c={s:O,z:function(y){var b=-y.utcOffset(),g=Math.abs(b),w=Math.floor(g/60),v=g%60;return(b<=0?"+":"-")+O(w,2,"0")+":"+O(v,2,"0")},m:function y(b,g){if(b.date()<g.date())return-y(g,b);var w=12*(g.year()-b.year())+(g.month()-b.month()),v=b.clone().add(w,d),M=g-v<0,N=b.clone().add(w+(M?-1:1),d);return+(-(w+(g-v)/(M?v-N:N-v))||0)},a:function(y){return y<0?Math.ceil(y)||0:Math.floor(y)},p:function(y){return{M:d,y:f,w:l,d:r,D:m,h:o,m:n,s:a,ms:s,Q:u}[y]||String(y||"").toLowerCase().replace(/s$/,"")},u:function(y){return y===void 0}},_="en",$={};$[_]=x;var V="$isDayjsObject",S=function(y){return y instanceof k||!(!y||!y[V])},A=function y(b,g,w){var v;if(!b)return _;if(typeof b=="string"){var M=b.toLowerCase();$[M]&&(v=M),g&&($[M]=g,v=M);var N=b.split("-");if(!v&&N.length>1)return y(N[0])}else{var T=b.name;$[T]=b,v=T}return!w&&v&&(_=v),v||!w&&_},E=function(y,b){if(S(y))return y.clone();var g=typeof b=="object"?b:{};return g.date=y,g.args=arguments,new k(g)},D=c;D.l=A,D.i=S,D.w=function(y,b){return E(y,{locale:b.$L,utc:b.$u,x:b.$x,$offset:b.$offset})};var k=function(){function y(g){this.$L=A(g.locale,null,!0),this.parse(g),this.$x=this.$x||g.x||{},this[V]=!0}var b=y.prototype;return b.parse=function(g){this.$d=function(w){var v=w.date,M=w.utc;if(v===null)return new Date(NaN);if(D.u(v))return new Date;if(v instanceof Date)return new Date(v);if(typeof v=="string"&&!/Z$/i.test(v)){var N=v.match(p);if(N){var T=N[2]-1||0,H=(N[7]||"0").substring(0,3);return M?new Date(Date.UTC(N[1],T,N[3]||1,N[4]||0,N[5]||0,N[6]||0,H)):new Date(N[1],T,N[3]||1,N[4]||0,N[5]||0,N[6]||0,H)}}return new Date(v)}(g),this.init()},b.init=function(){var g=this.$d;this.$y=g.getFullYear(),this.$M=g.getMonth(),this.$D=g.getDate(),this.$W=g.getDay(),this.$H=g.getHours(),this.$m=g.getMinutes(),this.$s=g.getSeconds(),this.$ms=g.getMilliseconds()},b.$utils=function(){return D},b.isValid=function(){return this.$d.toString()!==h},b.isSame=function(g,w){var v=E(g);return this.startOf(w)<=v&&v<=this.endOf(w)},b.isAfter=function(g,w){return E(g)<this.startOf(w)},b.isBefore=function(g,w){return this.endOf(w)<E(g)},b.$g=function(g,w,v){return D.u(g)?this[w]:this.set(v,g)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(g,w){var v=this,M=!!D.u(w)||w,N=D.p(g),T=function(X,z){var G=D.w(v.$u?Date.UTC(v.$y,z,X):new Date(v.$y,z,X),v);return M?G:G.endOf(r)},H=function(X,z){return D.w(v.toDate()[X].apply(v.toDate("s"),(M?[0,0,0,0]:[23,59,59,999]).slice(z)),v)},j=this.$W,U=this.$M,J=this.$D,ne="set"+(this.$u?"UTC":"");switch(N){case f:return M?T(1,0):T(31,11);case d:return M?T(1,U):T(0,U+1);case l:var ee=this.$locale().weekStart||0,ie=(j<ee?j+7:j)-ee;return T(M?J-ie:J+(6-ie),U);case r:case m:return H(ne+"Hours",0);case o:return H(ne+"Minutes",1);case n:return H(ne+"Seconds",2);case a:return H(ne+"Milliseconds",3);default:return this.clone()}},b.endOf=function(g){return this.startOf(g,!1)},b.$set=function(g,w){var v,M=D.p(g),N="set"+(this.$u?"UTC":""),T=(v={},v[r]=N+"Date",v[m]=N+"Date",v[d]=N+"Month",v[f]=N+"FullYear",v[o]=N+"Hours",v[n]=N+"Minutes",v[a]=N+"Seconds",v[s]=N+"Milliseconds",v)[M],H=M===r?this.$D+(w-this.$W):w;if(M===d||M===f){var j=this.clone().set(m,1);j.$d[T](H),j.init(),this.$d=j.set(m,Math.min(this.$D,j.daysInMonth())).$d}else T&&this.$d[T](H);return this.init(),this},b.set=function(g,w){return this.clone().$set(g,w)},b.get=function(g){return this[D.p(g)]()},b.add=function(g,w){var v,M=this;g=Number(g);var N=D.p(w),T=function(U){var J=E(M);return D.w(J.date(J.date()+Math.round(U*g)),M)};if(N===d)return this.set(d,this.$M+g);if(N===f)return this.set(f,this.$y+g);if(N===r)return T(1);if(N===l)return T(7);var H=(v={},v[n]=e,v[o]=t,v[a]=i,v)[N]||1,j=this.$d.getTime()+g*H;return D.w(j,this)},b.subtract=function(g,w){return this.add(-1*g,w)},b.format=function(g){var w=this,v=this.$locale();if(!this.isValid())return v.invalidDate||h;var M=g||"YYYY-MM-DDTHH:mm:ssZ",N=D.z(this),T=this.$H,H=this.$m,j=this.$M,U=v.weekdays,J=v.months,ne=v.meridiem,ee=function(z,G,ae,oe){return z&&(z[G]||z(w,M))||ae[G].slice(0,oe)},ie=function(z){return D.s(T%12||12,z,"0")},X=ne||function(z,G,ae){var oe=z<12?"AM":"PM";return ae?oe.toLowerCase():oe};return M.replace(C,function(z,G){return G||function(ae){switch(ae){case"YY":return String(w.$y).slice(-2);case"YYYY":return D.s(w.$y,4,"0");case"M":return j+1;case"MM":return D.s(j+1,2,"0");case"MMM":return ee(v.monthsShort,j,J,3);case"MMMM":return ee(J,j);case"D":return w.$D;case"DD":return D.s(w.$D,2,"0");case"d":return String(w.$W);case"dd":return ee(v.weekdaysMin,w.$W,U,2);case"ddd":return ee(v.weekdaysShort,w.$W,U,3);case"dddd":return U[w.$W];case"H":return String(T);case"HH":return D.s(T,2,"0");case"h":return ie(1);case"hh":return ie(2);case"a":return X(T,H,!0);case"A":return X(T,H,!1);case"m":return String(H);case"mm":return D.s(H,2,"0");case"s":return String(w.$s);case"ss":return D.s(w.$s,2,"0");case"SSS":return D.s(w.$ms,3,"0");case"Z":return N}return null}(z)||N.replace(":","")})},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(g,w,v){var M,N=this,T=D.p(w),H=E(g),j=(H.utcOffset()-this.utcOffset())*e,U=this-H,J=function(){return D.m(N,H)};switch(T){case f:M=J()/12;break;case d:M=J();break;case u:M=J()/3;break;case l:M=(U-j)/6048e5;break;case r:M=(U-j)/864e5;break;case o:M=U/t;break;case n:M=U/e;break;case a:M=U/i;break;default:M=U}return v?M:D.a(M)},b.daysInMonth=function(){return this.endOf(d).$D},b.$locale=function(){return $[this.$L]},b.locale=function(g,w){if(!g)return this.$L;var v=this.clone(),M=A(g,w,!0);return M&&(v.$L=M),v},b.clone=function(){return D.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},y}(),R=k.prototype;return E.prototype=R,[["$ms",s],["$s",a],["$m",n],["$H",o],["$W",r],["$M",d],["$y",f],["$D",m]].forEach(function(y){R[y[1]]=function(b){return this.$g(b,y[0],y[1])}}),E.extend=function(y,b){return y.$i||(y(b,k,E),y.$i=!0),E},E.locale=A,E.isDayjs=S,E.unix=function(y){return E(1e3*y)},E.en=$[_],E.Ls=$,E.p={},E}()),ss={exports:{}},is=Pt(ss.exports=function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},e=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,t=/\d\d/,s=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,n={},o=function(h){return(h=+h)+(h>68?1900:2e3)},r=function(h){return function(p){this[h]=+p}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(h){(this.zone||(this.zone={})).offset=function(p){if(!p||p==="Z")return 0;var C=p.match(/([+-]|\d\d)/g),x=60*C[1]+(+C[2]||0);return x===0?0:C[0]==="+"?-x:x}(h)}],d=function(h){var p=n[h];return p&&(p.indexOf?p:p.s.concat(p.f))},u=function(h,p){var C,x=n.meridiem;if(x){for(var O=1;O<=24;O+=1)if(h.indexOf(x(O,0,p))>-1){C=O>12;break}}else C=h===(p?"pm":"PM");return C},f={A:[a,function(h){this.afternoon=u(h,!1)}],a:[a,function(h){this.afternoon=u(h,!0)}],S:[/\d/,function(h){this.milliseconds=100*+h}],SS:[t,function(h){this.milliseconds=10*+h}],SSS:[/\d{3}/,function(h){this.milliseconds=+h}],s:[s,r("seconds")],ss:[s,r("seconds")],m:[s,r("minutes")],mm:[s,r("minutes")],H:[s,r("hours")],h:[s,r("hours")],HH:[s,r("hours")],hh:[s,r("hours")],D:[s,r("day")],DD:[t,r("day")],Do:[a,function(h){var p=n.ordinal,C=h.match(/\d+/);if(this.day=C[0],p)for(var x=1;x<=31;x+=1)p(x).replace(/\[|\]/g,"")===h&&(this.day=x)}],M:[s,r("month")],MM:[t,r("month")],MMM:[a,function(h){var p=d("months"),C=(d("monthsShort")||p.map(function(x){return x.slice(0,3)})).indexOf(h)+1;if(C<1)throw new Error;this.month=C%12||C}],MMMM:[a,function(h){var p=d("months").indexOf(h)+1;if(p<1)throw new Error;this.month=p%12||p}],Y:[/[+-]?\d+/,r("year")],YY:[t,function(h){this.year=o(h)}],YYYY:[/\d{4}/,r("year")],Z:l,ZZ:l};function m(h){var p,C;p=h,C=n&&n.formats;for(var x=(h=p.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(A,E,D){var k=D&&D.toUpperCase();return E||C[D]||i[D]||C[k].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(R,y,b){return y||b.slice(1)})})).match(e),O=x.length,c=0;c<O;c+=1){var _=x[c],$=f[_],V=$&&$[0],S=$&&$[1];x[c]=S?{regex:V,parser:S}:_.replace(/^\[|\]$/g,"")}return function(A){for(var E={},D=0,k=0;D<O;D+=1){var R=x[D];if(typeof R=="string")k+=R.length;else{var y=R.regex,b=R.parser,g=A.slice(k),w=y.exec(g)[0];b.call(E,w),A=A.replace(w,"")}}return function(v){var M=v.afternoon;if(M!==void 0){var N=v.hours;M?N<12&&(v.hours+=12):N===12&&(v.hours=0),delete v.afternoon}}(E),E}}return function(h,p,C){C.p.customParseFormat=!0,h&&h.parseTwoDigitYear&&(o=h.parseTwoDigitYear);var x=p.prototype,O=x.parse;x.parse=function(c){var _=c.date,$=c.utc,V=c.args;this.$u=$;var S=V[1];if(typeof S=="string"){var A=V[2]===!0,E=V[3]===!0,D=A||E,k=V[2];E&&(k=V[2]),n=this.$locale(),!A&&k&&(n=C.Ls[k]),this.$d=function(g,w,v){try{if(["x","X"].indexOf(w)>-1)return new Date((w==="X"?1e3:1)*g);var M=m(w)(g),N=M.year,T=M.month,H=M.day,j=M.hours,U=M.minutes,J=M.seconds,ne=M.milliseconds,ee=M.zone,ie=new Date,X=H||(N||T?1:ie.getDate()),z=N||ie.getFullYear(),G=0;N&&!T||(G=T>0?T-1:ie.getMonth());var ae=j||0,oe=U||0,Re=J||0,He=ne||0;return ee?new Date(Date.UTC(z,G,X,ae,oe,Re,He+60*ee.offset*1e3)):v?new Date(Date.UTC(z,G,X,ae,oe,Re,He)):new Date(z,G,X,ae,oe,Re,He)}catch{return new Date("")}}(_,S,$),this.init(),k&&k!==!0&&(this.$L=this.locale(k).$L),D&&_!=this.format(S)&&(this.$d=new Date("")),n={}}else if(S instanceof Array)for(var R=S.length,y=1;y<=R;y+=1){V[1]=S[y-1];var b=C.apply(this,V);if(b.isValid()){this.$d=b.$d,this.$L=b.$L,this.init();break}y===R&&(this.$d=new Date(""))}else O.call(this,c)}}}());ye.extend(is);var It=(i,e)=>{let t;if(e)switch(e){case"ISO_8601":t=i;break;case"RFC_2822":t=ye(i.slice(5),"DD MMM YYYY HH:mm:ss ZZ").unix();break;case"MYSQL":t=ye(i,"YYYY-MM-DD hh:mm:ss").unix();break;case"UNIX":t=ye(i).unix();break;default:t=ye(i,e,!0).valueOf()}return t},ce=(i,e)=>{if(i?.constructor===Object&&Object.prototype.hasOwnProperty.call(i,"data")&&!Object.keys(i).find(s=>!["text","order","data","attributes"].includes(s)))return i;let t={data:i};switch(e.type){case"string":typeof i!="string"&&(t.text=String(t.data),t.order=t.text);break;case"date":e.format&&(t.order=It(String(t.data),e.format));break;case"number":t.text=String(t.data),t.data=parseFloat(t.data),t.order=t.data;break;case"html":{let s=Array.isArray(t.data)?{nodeName:"TD",childNodes:t.data}:de(`<td>${String(t.data)}</td>`);t.data=s.childNodes||[];let a=_e(s);t.text=a,t.order=a;break}case"boolean":typeof t.data=="string"&&(t.data=t.data.toLowerCase().trim()),t.data=!["false",!1,null,void 0,0].includes(t.data),t.order=t.data?1:0,t.text=String(t.data);break;case"other":t.text="",t.order=0;break;default:t.text=JSON.stringify(t.data)}return t},we=i=>{if(i instanceof Object&&i.constructor===Object&&i.hasOwnProperty("data")&&(typeof i.text=="string"||typeof i.data=="string"))return i;let e={data:i};if(typeof i=="string"){if(i.length){let t=de(`<th>${i}</th>`);if(t.childNodes&&(t.childNodes.length!==1||t.childNodes[0].nodeName!=="#text")){e.data=t.childNodes,e.type="html";let s=_e(t);e.text=s}}}else[null,void 0].includes(i)?e.text="":e.text=JSON.stringify(i);return e},Tt=(i,e=void 0,t,s,a)=>{let n={data:[],headings:[]};if(i.headings)n.headings=i.headings.map(o=>we(o));else if(e?.tHead)n.headings=Array.from(e.tHead.querySelectorAll("th")).map((o,r)=>{let l=(u=>{let f=le(u,{valueDiffing:!1}),m;return m=!f.childNodes||f.childNodes.length===1&&f.childNodes[0].nodeName==="#text"?{data:u.innerText,type:"string"}:{data:f.childNodes,type:"html",text:_e(f)},m.attributes=f.attributes,m})(o);t[r]||(t[r]={type:s,format:a,searchable:!0,sortable:!0});let d=t[r];return o.dataset.sortable?.trim().toLowerCase()!=="false"&&o.dataset.sort?.trim().toLowerCase()!=="false"||(d.sortable=!1),o.dataset.searchable?.trim().toLowerCase()==="false"&&(d.searchable=!1),o.dataset.hidden?.trim().toLowerCase()!=="true"&&o.getAttribute("hidden")?.trim().toLowerCase()!=="true"||(d.hidden=!0),["number","string","html","date","boolean","other"].includes(o.dataset.type)&&(d.type=o.dataset.type,d.type==="date"&&o.dataset.format&&(d.format=o.dataset.format)),l});else if(i.data?.length){let o=i.data[0],r=Array.isArray(o)?o:o.cells;n.headings=r.map(l=>we(""))}else e?.tBodies.length&&(n.headings=Array.from(e.tBodies[0].rows[0].cells).map(o=>we("")));for(let o=0;o<n.headings.length;o++)t[o]||(t[o]={type:s,format:a,sortable:!0,searchable:!0});if(i.data){let o=n.headings.map(r=>r.data?String(r.data):r.text);n.data=i.data.map(r=>{let l,d;return Array.isArray(r)?(l={},d=r):r.hasOwnProperty("cells")&&Object.keys(r).every(u=>["cells","attributes"].includes(u))?(l=r.attributes,d=r.cells):(l={},d=[],Object.entries(r).forEach(([u,f])=>{let m=o.indexOf(u);m>-1&&(d[m]=f)})),{attributes:l,cells:d.map((u,f)=>ce(u,t[f]))}})}else e?.tBodies?.length&&(n.data=Array.from(e.tBodies[0].rows).map(o=>({attributes:Ot(o.attributes),cells:Array.from(o.cells).map((r,l)=>{let d=r.dataset.content?ce(r.dataset.content,t[l]):((u,f)=>{let m;switch(f.type){case"string":m={data:u.innerText};break;case"date":{let h=u.innerText;m={data:h,order:It(h,f.format)};break}case"number":{let h=parseFloat(u.innerText);m={data:h,order:h,text:u.innerText};break}case"boolean":{let h=!["false","0","null","undefined"].includes(u.innerText.toLowerCase().trim());m={data:h,text:h?"1":"0",order:h?1:0};break}default:m={data:le(u,{valueDiffing:!1}).childNodes||[],text:u.innerText,order:u.innerText}}return m.attributes=Ot(u.attributes),m})(r,t[l]);return r.dataset.order&&(d.order=isNaN(parseFloat(r.dataset.order))?r.dataset.order:parseFloat(r.dataset.order)),d})})));if(n.data.length&&n.data[0].cells.length!==n.headings.length)throw new Error("Data heading length mismatch.");return n},tt=class{cursor;dt;constructor(e){this.dt=e,this.cursor=!1}setCursor(e=!1){if(e===this.cursor)return;let t=this.cursor;if(this.cursor=e,this.dt._renderTable(),e!==!1&&this.dt.options.scrollY){let s=re(this.dt.options.classes.cursor),a=this.dt.dom.querySelector(`tr${s}`);a&&a.scrollIntoView({block:"nearest"})}this.dt.emit("datatable.cursormove",this.cursor,t)}add(e){if(!Array.isArray(e)||e.length<1)return;let t={cells:e.map((s,a)=>{let n=this.dt.columns.settings[a];return ce(s,n)})};this.dt.data.data.push(t),this.dt.hasRows=!0,this.dt.update(!0)}remove(e){if(!Array.isArray(e))return this.remove([e]);this.dt.data.data=this.dt.data.data.filter((t,s)=>!e.includes(s)),this.dt.data.data.length||(this.dt.hasRows=!1),this.dt.update(!0)}findRowIndex(e,t){return this.dt.data.data.findIndex(s=>{let a=s.cells[e];return he(a).toLowerCase().includes(String(t).toLowerCase())})}findRow(e,t){let s=this.findRowIndex(e,t);if(s<0)return{index:-1,row:null,cols:[]};let a=this.dt.data.data[s],n=a.cells.map(o=>o.data);return{index:s,row:a,cols:n}}updateRow(e,t){let s={cells:t.map((a,n)=>{let o=this.dt.columns.settings[n];return ce(a,o)})};this.dt.data.data.splice(e,1,s),this.dt.update(!0)}},st=class{dt;settings;_state;constructor(e){this.dt=e,this.init()}init(){[this.settings,this._state]=((e=[],t,s)=>{let a=[],n=!1,o=[];return e.forEach(r=>{(Array.isArray(r.select)?r.select:[r.select]).forEach(l=>{a[l]?r.type&&(a[l].type=r.type):a[l]={type:r.type||t,sortable:!0,searchable:!0};let d=a[l];r.render&&(d.render=r.render),r.format?d.format=r.format:r.type==="date"&&(d.format=s),r.cellClass&&(d.cellClass=r.cellClass),r.headerClass&&(d.headerClass=r.headerClass),r.locale&&(d.locale=r.locale),r.sortable===!1?d.sortable=!1:(r.numeric&&(d.numeric=r.numeric),r.caseFirst&&(d.caseFirst=r.caseFirst)),r.searchable===!1?d.searchable=!1:r.sensitivity&&(d.sensitivity=r.sensitivity),(d.searchable||d.sortable)&&r.ignorePunctuation!==void 0&&(d.ignorePunctuation=r.ignorePunctuation),r.searchMethod&&(d.searchMethod=r.searchMethod),r.hidden&&(d.hidden=!0),r.filter&&(d.filter=r.filter),r.sortSequence&&(d.sortSequence=r.sortSequence),r.sort&&(r.filter?o[l]=r.sort:n={column:l,dir:r.sort}),r.searchItemSeparator!==void 0&&(d.searchItemSeparator=r.searchItemSeparator)})}),a=a.map(r=>r||{type:t,format:t==="date"?s:void 0,sortable:!0,searchable:!0}),[a,{filters:o,sort:n,widths:[]}]})(this.dt.options.columns,this.dt.options.type,this.dt.options.format)}get(e){return e<0||e>=this.size()?null:Q({},this.settings[e])}size(){return this.settings.length}swap(e){if(e.length===2){let t=this.dt.data.headings.map((o,r)=>r),s=e[0],a=e[1],n=t[a];return t[a]=t[s],t[s]=n,this.order(t)}}order(e){this.dt.data.headings=e.map(t=>this.dt.data.headings[t]),this.dt.data.data.forEach(t=>t.cells=e.map(s=>t.cells[s])),this.settings=e.map(t=>this.settings[t]),this.dt.update()}hide(e){Array.isArray(e)||(e=[e]),e.length&&(e.forEach(t=>{this.settings[t]||(this.settings[t]={type:"string"}),this.settings[t].hidden=!0}),this.dt.update())}show(e){Array.isArray(e)||(e=[e]),e.length&&(e.forEach(t=>{this.settings[t]||(this.settings[t]={type:"string",sortable:!0}),delete this.settings[t].hidden}),this.dt.update())}visible(e){return e===void 0&&(e=[...Array(this.dt.data.headings.length).keys()]),Array.isArray(e)?e.map(t=>!this.settings[t]?.hidden):!this.settings[e]?.hidden}add(e){let t=this.dt.data.headings.length;if(this.dt.data.headings=this.dt.data.headings.concat([we(e.heading)]),this.dt.data.data.forEach((s,a)=>{s.cells=s.cells.concat([ce(e.data[a],e)])}),this.settings[t]={type:e.type||"string",sortable:!0,searchable:!0},e.type||e.format||e.sortable||e.render||e.filter){let s=this.settings[t];e.render&&(s.render=e.render),e.format&&(s.format=e.format),e.cellClass&&(s.cellClass=e.cellClass),e.headerClass&&(s.headerClass=e.headerClass),e.locale&&(s.locale=e.locale),e.sortable===!1?s.sortable=!1:(e.numeric&&(s.numeric=e.numeric),e.caseFirst&&(s.caseFirst=e.caseFirst)),e.searchable===!1?s.searchable=!1:e.sensitivity&&(s.sensitivity=e.sensitivity),(s.searchable||s.sortable)&&e.ignorePunctuation&&(s.ignorePunctuation=e.ignorePunctuation),e.hidden&&(s.hidden=!0),e.filter&&(s.filter=e.filter),e.sortSequence&&(s.sortSequence=e.sortSequence)}this.dt.update(!0)}remove(e){Array.isArray(e)||(e=[e]),this.dt.data.headings=this.dt.data.headings.filter((t,s)=>!e.includes(s)),this.dt.data.data.forEach(t=>t.cells=t.cells.filter((s,a)=>!e.includes(a))),this.dt.update(!0)}filter(e,t=!1){if(!this.settings[e]?.filter?.length)return;let s=this._state.filters[e],a;if(s){let n=!1;a=this.settings[e].filter.find(o=>!!n||(o===s&&(n=!0),!1))}else{let n=this.settings[e].filter;a=n?n[0]:void 0}a?this._state.filters[e]=a:s&&(this._state.filters[e]=void 0),this.dt._currentPage=1,this.dt.update(),t||this.dt.emit("datatable.filter",e,a)}sort(e,t=void 0,s=!1){let a=this.settings[e];if(s||this.dt.emit("datatable.sorting",e,t),!t){let o=!(!this._state.sort||this._state.sort.column!==e)&&this._state.sort?.dir,r=a?.sortSequence||["asc","desc"];if(o){let l=r.indexOf(o);t=l===-1?r[0]||"asc":l===r.length-1?r[0]:r[l+1]}else t=r.length?r[0]:"asc"}let n=!!["string","html"].includes(a.type)&&new Intl.Collator(a.locale||this.dt.options.locale,{usage:"sort",numeric:a.numeric||this.dt.options.numeric,caseFirst:a.caseFirst||this.dt.options.caseFirst,ignorePunctuation:a.ignorePunctuation||this.dt.options.ignorePunctuation});this.dt.data.data.sort((o,r)=>{let l=o.cells[e],d=r.cells[e],u=l.order??he(l),f=d.order??he(d);if(t==="desc"){let m=u;u=f,f=m}return n&&typeof u!="number"&&typeof f!="number"?n.compare(String(u),String(f)):u<f?-1:u>f?1:0}),this._state.sort={column:e,dir:t},this.dt._searchQueries.length?(this.dt.multiSearch(this.dt._searchQueries),this.dt.emit("datatable.sort",e,t)):s||(this.dt._currentPage=1,this.dt.update(),this.dt.emit("datatable.sort",e,t))}_measureWidths(){let e=this.dt.data.headings.filter((t,s)=>!this.settings[s]?.hidden);if((this.dt.options.scrollY.length||this.dt.options.fixedColumns)&&e?.length){this._state.widths=[];let t={noPaging:!0};if(this.dt.options.header||this.dt.options.footer){this.dt.options.scrollY.length&&(t.unhideHeader=!0),this.dt.headerDOM&&this.dt.headerDOM.parentElement.removeChild(this.dt.headerDOM),t.noColumnWidths=!0,this.dt._renderTable(t);let s=Array.from(this.dt.dom.querySelector("thead, tfoot")?.firstElementChild?.querySelectorAll("th")||[]),a=0,n=this.dt.data.headings.map((r,l)=>{if(this.settings[l]?.hidden)return 0;let d=s[a].offsetWidth;return a+=1,d}),o=n.reduce((r,l)=>r+l,0);this._state.widths=n.map(r=>r/o*100)}else{t.renderHeader=!0,this.dt._renderTable(t);let s=Array.from(this.dt.dom.querySelector("thead, tfoot")?.firstElementChild?.querySelectorAll("th")||[]),a=0,n=this.dt.data.headings.map((r,l)=>{if(this.settings[l]?.hidden)return 0;let d=s[a].offsetWidth;return a+=1,d}),o=n.reduce((r,l)=>r+l,0);this._state.widths=n.map(r=>r/o*100)}this.dt._renderTable()}}},Te={sortable:!0,locale:"en",numeric:!0,caseFirst:"false",searchable:!0,sensitivity:"base",ignorePunctuation:!0,destroyable:!0,searchItemSeparator:"",searchQuerySeparator:" ",searchAnd:!1,searchMethod:!1,data:{},type:"html",format:"YYYY-MM-DD",columns:[],paging:!0,perPage:10,perPageSelect:[5,10,15,20,25],nextPrev:!0,firstLast:!1,prevText:"\u2039",nextText:"\u203A",firstText:"\xAB",lastText:"\xBB",ellipsisText:"\u2026",truncatePager:!0,pagerDelta:2,scrollY:"",fixedColumns:!0,fixedHeight:!1,footer:!1,header:!0,hiddenHeader:!1,caption:void 0,rowNavigation:!1,rowSelectionKeys:["Enter"," "],tabIndex:!1,pagerRender:!1,rowRender:!1,tableRender:!1,diffDomOptions:{valueDiffing:!1},labels:{placeholder:"Search...",searchTitle:"Search within table",perPage:"entries per page",pageTitle:"Page {page}",noRows:"No entries found",noResults:"No results match your search query",info:"Showing {start} to {end} of {rows} entries"},template:(i,e)=>`<div class='${i.classes.top}'>
    ${i.paging&&i.perPageSelect?`<div class='${i.classes.dropdown}'>
            <label>
                <select class='${i.classes.selector}' name="per-page"></select> ${i.labels.perPage}
            </label>
        </div>`:""}
    ${i.searchable?`<div class='${i.classes.search}'>
            <input class='${i.classes.input}' placeholder='${i.labels.placeholder}' type='search' name="search" title='${i.labels.searchTitle}'${e.id?` aria-controls="${e.id}"`:""}>
        </div>`:""}
</div>
<div class='${i.classes.container}'${i.scrollY.length?` style='height: ${i.scrollY}; overflow-Y: auto;'`:""}></div>
<div class='${i.classes.bottom}'>
    ${i.paging?`<div class='${i.classes.info}'></div>`:""}
    <nav class='${i.classes.pagination}'></nav>
</div>`,classes:{active:"datatable-active",ascending:"datatable-ascending",bottom:"datatable-bottom",container:"datatable-container",cursor:"datatable-cursor",descending:"datatable-descending",disabled:"datatable-disabled",dropdown:"datatable-dropdown",ellipsis:"datatable-ellipsis",filter:"datatable-filter",filterActive:"datatable-filter-active",empty:"datatable-empty",headercontainer:"datatable-headercontainer",hidden:"datatable-hidden",info:"datatable-info",input:"datatable-input",loading:"datatable-loading",pagination:"datatable-pagination",paginationList:"datatable-pagination-list",paginationListItem:"datatable-pagination-list-item",paginationListItemLink:"datatable-pagination-list-item-link",search:"datatable-search",selector:"datatable-selector",sorter:"datatable-sorter",table:"datatable-table",top:"datatable-top",wrapper:"datatable-wrapper"}},ve=(i,e,t,s={})=>({nodeName:"LI",attributes:{class:s.active&&!s.hidden?`${t.classes.paginationListItem} ${t.classes.active}`:s.hidden?`${t.classes.paginationListItem} ${t.classes.hidden} ${t.classes.disabled}`:t.classes.paginationListItem},childNodes:[{nodeName:"BUTTON",attributes:{"data-page":String(i),class:t.classes.paginationListItemLink,"aria-label":t.labels.pageTitle.replace("{page}",String(i))},childNodes:[{nodeName:"#text",data:e}]}]}),as=(i,e,t,s,a)=>{let n=[];if(a.firstLast&&n.push(ve(1,a.firstText,a)),a.nextPrev){let r=i?1:t-1;n.push(ve(r,a.prevText,a,{hidden:i}))}let o=[...Array(s).keys()].map(r=>ve(r+1,String(r+1),a,{active:r===t-1}));if(a.truncatePager&&(o=((r,l,d,u)=>{let f=u.pagerDelta,m=u.classes,h=u.ellipsisText,p=2*f,C=l-f,x=l+f;l<4-f+p?x=3+p:l>d-(3-f+p)&&(C=d-(2+p));let O=[];for(let $=1;$<=d;$++)if($==1||$==d||$>=C&&$<=x){let V=r[$-1];O.push(V)}let c,_=[];return O.forEach($=>{let V=parseInt($.childNodes[0].attributes["data-page"],10);if(c){let S=parseInt(c.childNodes[0].attributes["data-page"],10);if(V-S==2)_.push(r[S]);else if(V-S!=1){let A={nodeName:"LI",attributes:{class:`${m.paginationListItem} ${m.ellipsis} ${m.disabled}`},childNodes:[{nodeName:"BUTTON",attributes:{class:m.paginationListItemLink},childNodes:[{nodeName:"#text",data:h}]}]};_.push(A)}}_.push($),c=$}),_})(o,t,s,a)),n=n.concat(o),a.nextPrev){let r=e?s:t+1;n.push(ve(r,a.nextText,a,{hidden:e}))}return a.firstLast&&n.push(ve(s,a.lastText,a)),{nodeName:"UL",attributes:{class:a.classes.paginationList},childNodes:o.length>1?n:[]}},Pe=class{columns;containerDOM;_currentPage;data;_dd;dom;_events;hasHeadings;hasRows;headerDOM;_initialHTML;initialized;_label;lastPage;_listeners;onFirstPage;onLastPage;options;_pagerDOMs;_virtualPagerDOM;pages;_rect;rows;_searchData;_searchQueries;_tableAttributes;_tableFooters;_tableCaptions;totalPages;_virtualDOM;_virtualHeaderDOM;wrapperDOM;constructor(e,t={}){let s=typeof e=="string"?document.querySelector(e):e;s instanceof HTMLTableElement?this.dom=s:(this.dom=document.createElement("table"),s.appendChild(this.dom));let a=Q(Q({},Te.diffDomOptions),t.diffDomOptions),n=Q(Q({},Te.labels),t.labels),o=Q(Q({},Te.classes),t.classes);this.options=Ye(Q(Q({},Te),t),{diffDomOptions:a,labels:n,classes:o}),this._initialHTML=this.options.destroyable?s.outerHTML:"",this.options.tabIndex?this.dom.tabIndex=this.options.tabIndex:this.options.rowNavigation&&this.dom.tabIndex===-1&&(this.dom.tabIndex=0),this._listeners={onResize:()=>this._onResize()},this._dd=new es(this.options.diffDomOptions||{}),this.initialized=!1,this._events={},this._currentPage=0,this.onFirstPage=!0,this.hasHeadings=!1,this.hasRows=!1,this._searchQueries=[],this.init()}init(){if(this.initialized||Be(this.dom,this.options.classes.table))return!1;this._virtualDOM=le(this.dom,this.options.diffDomOptions||{}),this._tableAttributes=Q({},this._virtualDOM.attributes),this._tableFooters=this._virtualDOM.childNodes?.filter(e=>e.nodeName==="TFOOT")??[],this._tableCaptions=this._virtualDOM.childNodes?.filter(e=>e.nodeName==="CAPTION")??[],this.options.caption!==void 0&&this._tableCaptions.push({nodeName:"CAPTION",childNodes:[{nodeName:"#text",data:this.options.caption}]}),this.rows=new tt(this),this.columns=new st(this),this.data=Tt(this.options.data,this.dom,this.columns.settings,this.options.type,this.options.format),this._render(),setTimeout(()=>{this.emit("datatable.init"),this.initialized=!0},10)}_render(){this.wrapperDOM=ze("div",{class:`${this.options.classes.wrapper} ${this.options.classes.loading}`}),this.wrapperDOM.innerHTML=this.options.template(this.options,this.dom);let e=re(this.options.classes.selector),t=this.wrapperDOM.querySelector(`select${e}`);t&&this.options.paging&&this.options.perPageSelect?this.options.perPageSelect.forEach(o=>{let[r,l]=Array.isArray(o)?[o[0],o[1]]:[String(o),o],d=l===this.options.perPage,u=new Option(r,String(l),d,d);t.appendChild(u)}):t&&t.parentElement.removeChild(t);let s=re(this.options.classes.container);this.containerDOM=this.wrapperDOM.querySelector(s),this._pagerDOMs=[];let a=re(this.options.classes.pagination);Array.from(this.wrapperDOM.querySelectorAll(a)).forEach(o=>{o instanceof HTMLElement&&(o.innerHTML=`<ul class="${this.options.classes.paginationList}"></ul>`,this._pagerDOMs.push(o.firstElementChild))}),this._virtualPagerDOM={nodeName:"UL",attributes:{class:this.options.classes.paginationList}};let n=re(this.options.classes.info);this._label=this.wrapperDOM.querySelector(n),this.dom.parentElement.replaceChild(this.wrapperDOM,this.dom),this.containerDOM.appendChild(this.dom),this._rect=this.dom.getBoundingClientRect(),this._fixHeight(),this.options.header||this.wrapperDOM.classList.add("no-header"),this.options.footer||this.wrapperDOM.classList.add("no-footer"),this.options.sortable&&this.wrapperDOM.classList.add("sortable"),this.options.searchable&&this.wrapperDOM.classList.add("searchable"),this.options.fixedHeight&&this.wrapperDOM.classList.add("fixed-height"),this.options.fixedColumns&&this.wrapperDOM.classList.add("fixed-columns"),this._bindEvents(),this.columns._state.sort&&this.columns.sort(this.columns._state.sort.column,this.columns._state.sort.dir,!0),this.update(!0)}_renderTable(e={}){let t;t=(this.options.paging||this._searchQueries.length||this.columns._state.filters.length)&&this._currentPage&&this.pages.length&&!e.noPaging?this.pages[this._currentPage-1]:this.data.data.map((n,o)=>({row:n,index:o}));let s=kt(this._tableAttributes,this.data.headings,t,this.columns.settings,this.columns._state,this.rows.cursor,this.options,e,this._tableFooters,this._tableCaptions);if(this.options.tableRender){let n=this.options.tableRender(this.data,s,"main");n&&(s=n)}let a=this._dd.diff(this._virtualDOM,s);this._dd.apply(this.dom,a),this._virtualDOM=s}_renderPage(e=!1){this.hasRows&&this.totalPages?(this._currentPage>this.totalPages&&(this._currentPage=1),this._renderTable(),this.onFirstPage=this._currentPage===1,this.onLastPage=this._currentPage===this.lastPage):this.setMessage(this.options.labels.noRows);let t,s=0,a=0,n=0;if(this.totalPages&&(s=this._currentPage-1,a=s*this.options.perPage,n=a+this.pages[s].length,a+=1,t=this._searchQueries.length?this._searchData.length:this.data.data.length),this._label&&this.options.labels.info.length){let o=this.options.labels.info.replace("{start}",String(a)).replace("{end}",String(n)).replace("{page}",String(this._currentPage)).replace("{pages}",String(this.totalPages)).replace("{rows}",String(t));this._label.innerHTML=t?o:""}if(this._currentPage==1&&this._fixHeight(),this.options.rowNavigation&&this._currentPage&&(!this.rows.cursor||!this.pages[this._currentPage-1].find(o=>o.index===this.rows.cursor))){let o=this.pages[this._currentPage-1];o.length&&(e?this.rows.setCursor(o[o.length-1].index):this.rows.setCursor(o[0].index))}}_renderPagers(){if(!this.options.paging)return;let e=as(this.onFirstPage,this.onLastPage,this._currentPage,this.totalPages,this.options);if(this.options.pagerRender){let s=this.options.pagerRender([this.onFirstPage,this.onLastPage,this._currentPage,this.totalPages],e);s&&(e=s)}let t=this._dd.diff(this._virtualPagerDOM,e);this._pagerDOMs.forEach(s=>{this._dd.apply(s,t)}),this._virtualPagerDOM=e}_renderSeparateHeader(){let e=this.dom.parentElement;this.headerDOM||(this.headerDOM=document.createElement("div"),this._virtualHeaderDOM={nodeName:"DIV"}),e.parentElement.insertBefore(this.headerDOM,e);let t={nodeName:"TABLE",attributes:this._tableAttributes,childNodes:[{nodeName:"THEAD",childNodes:[et(this.data.headings,this.columns.settings,this.columns._state,this.options,{unhideHeader:!0})]}]};if(t.attributes.class=K(t.attributes.class,this.options.classes.table),this.options.tableRender){let o=this.options.tableRender(this.data,t,"header");o&&(t=o)}let s={nodeName:"DIV",attributes:{class:this.options.classes.headercontainer},childNodes:[t]},a=this._dd.diff(this._virtualHeaderDOM,s);this._dd.apply(this.headerDOM,a),this._virtualHeaderDOM=s;let n=this.headerDOM.firstElementChild.clientWidth-this.dom.clientWidth;if(n){let o=structuredClone(this._virtualHeaderDOM);o.attributes.style=`padding-right: ${n}px;`;let r=this._dd.diff(this._virtualHeaderDOM,o);this._dd.apply(this.headerDOM,r),this._virtualHeaderDOM=o}e.scrollHeight>e.clientHeight&&(e.style.overflowY="scroll")}_bindEvents(){if(this.options.perPageSelect){let e=re(this.options.classes.selector),t=this.wrapperDOM.querySelector(e);t&&t instanceof HTMLSelectElement&&t.addEventListener("change",()=>{this.emit("datatable.perpage:before",this.options.perPage),this.options.perPage=parseInt(t.value,10),this.update(),this._fixHeight(),this.emit("datatable.perpage",this.options.perPage)},!1)}this.options.searchable&&this.wrapperDOM.addEventListener("input",e=>{let t=re(this.options.classes.input),s=e.target;if(!(s instanceof HTMLInputElement&&s.matches(t)))return;e.preventDefault();let a=[];if(Array.from(this.wrapperDOM.querySelectorAll(t)).filter(n=>n.value.length).forEach(n=>{let o=n.dataset.and||this.options.searchAnd,r=n.dataset.querySeparator||this.options.searchQuerySeparator?n.value.split(this.options.searchQuerySeparator):[n.value];o?r.forEach(l=>{n.dataset.columns?a.push({terms:[l],columns:JSON.parse(n.dataset.columns)}):a.push({terms:[l],columns:void 0})}):n.dataset.columns?a.push({terms:r,columns:JSON.parse(n.dataset.columns)}):a.push({terms:r,columns:void 0})}),a.length===1&&a[0].terms.length===1){let n=a[0];this.search(n.terms[0],n.columns)}else this.multiSearch(a)}),this.wrapperDOM.addEventListener("click",e=>{let t=e.target.closest("a, button");if(t){if(t.hasAttribute("data-page"))this.page(parseInt(t.getAttribute("data-page"),10)),e.preventDefault();else if(Be(t,this.options.classes.sorter)){let s=Array.from(t.parentElement.parentElement.children).indexOf(t.parentElement),a=Nt(s,this.columns.settings);this.columns.sort(a),e.preventDefault()}else if(Be(t,this.options.classes.filter)){let s=Array.from(t.parentElement.parentElement.children).indexOf(t.parentElement),a=Nt(s,this.columns.settings);this.columns.filter(a),e.preventDefault()}}},!1),this.options.rowNavigation&&this.dom.addEventListener("keydown",e=>{if(e.key==="ArrowUp"){let t;e.preventDefault(),e.stopPropagation(),this.pages[this._currentPage-1].find(s=>s.index===this.rows.cursor||(t=s,!1)),t?this.rows.setCursor(t.index):this.onFirstPage||this.page(this._currentPage-1,!0)}else if(e.key==="ArrowDown"){let t;e.preventDefault(),e.stopPropagation();let s=this.pages[this._currentPage-1].find(a=>!!t||(a.index===this.rows.cursor&&(t=!0),!1));s?this.rows.setCursor(s.index):this.onLastPage||this.page(this._currentPage+1)}else this.options.rowSelectionKeys.includes(e.key)&&this.emit("datatable.selectrow",this.rows.cursor,e,!0)}),this.dom.addEventListener("mousedown",e=>{let t=e.target;if(!(t instanceof Element))return;let s=Array.from(this.dom.querySelectorAll("tbody > tr")).find(a=>a.contains(t));s&&s instanceof HTMLElement&&this.emit("datatable.selectrow",parseInt(s.dataset.index,10),e,this.dom.matches(":focus"))}),window.addEventListener("resize",this._listeners.onResize)}_onResize=Ut(()=>{this._rect=this.containerDOM.getBoundingClientRect(),this._rect.width&&this.update(!0)},250);destroy(){if(this.options.destroyable){if(this.wrapperDOM){let e=this.wrapperDOM.parentElement;if(e){let t=ze("div");t.innerHTML=this._initialHTML;let s=t.firstElementChild;e.replaceChild(s,this.wrapperDOM),this.dom=s}else this.options.classes.table?.split(" ").forEach(t=>this.wrapperDOM.classList.remove(t))}window.removeEventListener("resize",this._listeners.onResize),this.initialized=!1}}update(e=!1){this.emit("datatable.update:before"),e&&(this.columns._measureWidths(),this.hasRows=!!this.data.data.length,this.hasHeadings=!!this.data.headings.length),this.options.classes.empty?.split(" ").forEach(t=>this.wrapperDOM.classList.remove(t)),this._paginate(),this._renderPage(),this._renderPagers(),this.options.scrollY.length&&this._renderSeparateHeader(),this.emit("datatable.update")}_paginate(){let e=this.data.data.map((t,s)=>({row:t,index:s}));return this._searchQueries.length&&(e=[],this._searchData.forEach(t=>e.push({index:t,row:this.data.data[t]}))),this.columns._state.filters.length&&this.columns._state.filters.forEach((t,s)=>{t&&(e=e.filter(a=>{let n=a.row.cells[s];return typeof t=="function"?t(n.data):he(n)===t}))}),this.options.paging&&this.options.perPage>0?this.pages=e.map((t,s)=>s%this.options.perPage==0?e.slice(s,s+this.options.perPage):null).filter(t=>t):this.pages=[e],this.totalPages=this.lastPage=this.pages.length,this._currentPage||(this._currentPage=1),this.totalPages}_fixHeight(){this.options.fixedHeight&&(this.containerDOM.style.height=null,this._rect=this.containerDOM.getBoundingClientRect(),this.containerDOM.style.height=`${this._rect.height}px`)}search(e,t=void 0,s="search"){if(this.emit("datatable.search:before",e,this._searchData),!e.length)return this._currentPage=1,this._searchQueries=[],this._searchData=[],this.update(),this.emit("datatable.search","",[]),this.wrapperDOM.classList.remove("search-results"),!1;this.multiSearch([{terms:[e],columns:t||void 0}],s),this.emit("datatable.search",e,this._searchData)}multiSearch(e,t="search"){if(!this.hasRows)return!1;this._currentPage=1,this._searchData=[];let s=e.map(n=>({columns:n.columns,terms:n.terms.map(o=>o.trim()).filter(o=>o),source:t})).filter(n=>n.terms.length);if(this.emit("datatable.multisearch:before",s,this._searchData),t.length&&(s=s.concat(this._searchQueries.filter(n=>n.source!==t))),this._searchQueries=s,!s.length)return this.update(),this.emit("datatable.multisearch",s,this._searchData),this.wrapperDOM.classList.remove("search-results"),!1;let a=s.map(n=>this.columns.settings.map((o,r)=>{if(o.hidden||!o.searchable||n.columns&&!n.columns.includes(r))return!1;let l=n.terms,d=o.sensitivity||this.options.sensitivity;return["base","accent"].includes(d)&&(l=l.map(u=>u.toLowerCase())),["base","case"].includes(d)&&(l=l.map(u=>u.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),""))),(o.ignorePunctuation??this.options.ignorePunctuation)&&(l=l.map(u=>u.replace(/[.,/#!$%^&*;:{}=-_`~()]/g,""))),l}));this.data.data.forEach((n,o)=>{let r=n.cells.map((l,d)=>{let u=this.columns.settings[d];if(u.searchMethod||this.options.searchMethod)return l;let f=he(l).trim();if(f.length){let h=u.sensitivity||this.options.sensitivity;["base","accent"].includes(h)&&(f=f.toLowerCase()),["base","case"].includes(h)&&(f=f.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")),(u.ignorePunctuation??this.options.ignorePunctuation)&&(f=f.replace(/[.,/#!$%^&*;:{}=-_`~()]/g,""))}let m=u.searchItemSeparator||this.options.searchItemSeparator;return m?f.split(m):[f]});a.every((l,d)=>l.find((u,f)=>{if(!u)return!1;let m=this.columns.settings[f].searchMethod||this.options.searchMethod;return m?m(u,r[f],n,f,s[d].source):u.find(h=>r[f].find(p=>p.includes(h)))}))&&this._searchData.push(o)}),this.wrapperDOM.classList.add("search-results"),this._searchData.length?this.update():(this.wrapperDOM.classList.remove("search-results"),this.setMessage(this.options.labels.noResults)),this.emit("datatable.multisearch",s,this._searchData)}page(e,t=!1){return this.emit("datatable.page:before",e),e!==this._currentPage&&(isNaN(e)||(this._currentPage=e),!(e>this.pages.length||e<0)&&(this._renderPage(t),this._renderPagers(),void this.emit("datatable.page",e)))}insert(e){let t=[];if(Array.isArray(e)){let s=this.data.headings.map(a=>a.data?String(a.data):a.text);e.forEach((a,n)=>{let o=[];Object.entries(a).forEach(([r,l])=>{let d=s.indexOf(r);d>-1?o[d]=ce(l,this.columns.settings[d]):this.hasHeadings||this.hasRows||n!==0||(o[s.length]=ce(l,this.columns.settings[s.length]),s.push(r),this.data.headings.push(we(r)))}),t.push({cells:o})})}else qt(e)&&(!e.headings||this.hasHeadings||this.hasRows?e.data&&Array.isArray(e.data)&&(t=e.data.map(s=>{let a,n;return Array.isArray(s)?(a={},n=s):(a=s.attributes,n=s.cells),{attributes:a,cells:n.map((o,r)=>ce(o,this.columns.settings[r]))}})):this.data=Tt(e,void 0,this.columns.settings,this.options.type,this.options.format));t.length&&t.forEach(s=>this.data.data.push(s)),this.hasHeadings=!!this.data.headings.length,this.columns._state.sort&&this.columns.sort(this.columns._state.sort.column,this.columns._state.sort.dir,!0),this.update(!0)}refresh(){if(this.emit("datatable.refresh:before"),this.options.searchable){let e=re(this.options.classes.input);Array.from(this.wrapperDOM.querySelectorAll(e)).forEach(t=>t.value=""),this._searchQueries=[]}this._currentPage=1,this.onFirstPage=!0,this.update(!0),this.emit("datatable.refresh")}print(){let e=ze("table"),t=kt(this._tableAttributes,this.data.headings,this.data.data.map((n,o)=>({row:n,index:o})),this.columns.settings,this.columns._state,!1,this.options,{noColumnWidths:!0,unhideHeader:!0},this._tableFooters,this._tableCaptions);if(this.options.tableRender){let n=this.options.tableRender(this.data,t,"print");n&&(t=n)}let s=this._dd.diff({nodeName:"TABLE"},t);this._dd.apply(e,s);let a=window.open();a.document.body.appendChild(e),a.print()}setMessage(e){let t=this.data.headings.filter((n,o)=>!this.columns.settings[o]?.hidden).length||1;this.options.classes.empty?.split(" ").forEach(n=>this.wrapperDOM.classList.add(n)),this._label&&(this._label.innerHTML=""),this.totalPages=0,this._renderPagers();let s={nodeName:"TABLE",attributes:this._tableAttributes,childNodes:[{nodeName:"THEAD",childNodes:[et(this.data.headings,this.columns.settings,this.columns._state,this.options,{})]},{nodeName:"TBODY",childNodes:[{nodeName:"TR",childNodes:[{nodeName:"TD",attributes:{class:this.options.classes.empty,colspan:String(t)},childNodes:[{nodeName:"#text",data:e}]}]}]}]};if(this._tableFooters.forEach(n=>s.childNodes.push(n)),this._tableCaptions.forEach(n=>s.childNodes.push(n)),s.attributes.class=K(s.attributes.class,this.options.classes.table),this.options.tableRender){let n=this.options.tableRender(this.data,s,"message");n&&(s=n)}let a=this._dd.diff(this._virtualDOM,s);this._dd.apply(this.dom,a),this._virtualDOM=s}on(e,t){this._events[e]=this._events[e]||[],this._events[e].push(t)}off(e,t){e in this._events&&this._events[e].splice(this._events[e].indexOf(t),1)}emit(e,...t){if(e in this._events)for(let s=0;s<this._events[e].length;s++)this._events[e][s](...t)}};var Ie=class i{actionCreateCategor;static \u0275fac=function(t){return new(t||i)};static \u0275cmp=pe({type:i,selectors:[["app-delete-category"]],inputs:{actionCreateCategor:"actionCreateCategor"},decls:16,vars:0,consts:[["id","delete-modal","tabindex","-1",1,"backdrop-blur-xs","hidden","overflow-y-auto","overflow-x-hidden","absolute","top-0","right-0","left-0","z-50","justify-center","items-center","w-full","md:inset-0","h-[calc(100%-1rem)]","max-h-full"],[1,"relative","p-4","w-full","max-w-md","max-h-full"],[1,"relative","bg-color","rounded-xl","animate-fadeIn"],["type","button","data-modal-hide","delete-modal",1,"absolute","cursor-pointer","top-3","end-2.5","text-gray-400","bg-transparent","hover:bg-gray-200","hover:text-gray-900","rounded-lg","text-sm","w-8","h-8","ms-auto","inline-flex","justify-center","items-center","dark:hover:bg-gray-600","dark:hover:text-white"],["type","button",1,"fa-solid","fa-close","cursor-pointer","text-xl"],[1,"sr-only"],[1,"p-4","md:p-5","text-center"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 20 20",1,"mx-auto","mb-4","text-gray-400","w-12","h-12","dark:text-gray-200"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"],[1,"mb-5","text-lg","font-normal","text-gray-500","dark:text-gray-400"],["data-modal-hide","delete-modal","type","button",1,"text-white","bg-red-600","hover:bg-red-800","focus:ring-4","focus:outline-none","focus:ring-red-300","dark:focus:ring-red-800","font-medium","rounded-lg","text-sm","inline-flex","items-center","px-5","py-2.5","text-center",3,"click"],["data-modal-hide","delete-modal","type","button",1,"py-2.5","px-5","ms-3","text-sm","font-medium","text-gray-900","focus:outline-none","bg-white","rounded-lg","border","border-gray-200","hover:bg-gray-100","hover:text-blue-700","focus:z-10","focus:ring-4","focus:ring-gray-100","dark:focus:ring-gray-700","dark:bg-gray-800","dark:text-gray-400","dark:border-gray-600","dark:hover:text-white","dark:hover:bg-gray-700"]],template:function(t,s){t&1&&(L(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),B(4,"span",4),L(5,"span",5),F(6,"Close modal"),P()(),L(7,"div",6),ot(),L(8,"svg",7),B(9,"path",8),P(),rt(),L(10,"h3",9),F(11,"Estas seguro de eliminar esta categor\xEDa?"),P(),L(12,"button",10),me("click",function(){return s.actionCreateCategor.set(!0)}),F(13," Si, eliminar "),P(),L(14,"button",11),F(15,"No, cancelar"),P()()()()())},encapsulation:2})};var ns=["categoryWrapper"],at=class i{category;categories=[];categoriesSend=[];categoryDeletedSuscription;categorySuscription;categoryService=Z(ge);loaderService=Z(Ve);toastr=Z($e);categoryCreated=ue(!1);resetForm=ue(!1);actionDeleteCategory=ue(!1);categoryId=ue(0);mode=ue("");dataTableInstance;constructor(){Oe(()=>{this.categoryCreated()&&(this.fetchCategories(),this.categoryCreated.set(!1)),this.actionDeleteCategory()&&(this.deleteCategory(),this.actionDeleteCategory.set(!1))})}datos={headings:["nombre","descripcion","estado","opciones"],data:[]};fetchCategories(){this.loaderService.activateInternalSignal(),this.categorySuscription=this.categoryService.getCategories().subscribe({next:e=>{this.categories=e.map(t=>[t.name,t.description,t.isActive,t.id]),this.categoriesSend=e,this.datos.data=this.categories,this.dataTableInstance&&this.dataTableInstance.destroy(),this.dataTableInstance=new Pe(this.category.nativeElement,{searchable:!0,paging:!0,sortable:!0,columns:[{select:2,type:"string",render:function(t,s,a,n){return t?'<div class="text-center w-full"><span class="fa fa-check text-green-500"></span> Activo</div>':'<div class="text-center w-full"><span class="fa fa-times text-red-500"></span> Inactivo</div>'}},{select:3,type:"string",render:function(t,s,a,n){return`
                  <div class="flex justify-center items-center gap-5 w-full">
                  <button type="button" data-id="${t}" data-action="edit" class="button-edit" data-modal-target="createCategory" data-modal-toggle="createCategory"><span class="fa-solid fa-pen-to-square"></span> Modificar</button>
                    <button type="button" data-id="${t}"  data-action="delete" class="button-cancel" data-modal-target="delete-modal" data-modal-toggle="delete-modal"><span class="fa-solid fa-trash"></span> Eliminar</button>
                `}}],classes:{active:"datatable-active",bottom:"datatable-bottom",container:"datatable-container",cursor:"datatable-cursor",dropdown:"datatable-dropdown",ellipsis:"datatable-ellipsis",empty:"datatable-empty",headercontainer:"datatable-headercontainer",info:"datatable-info",input:"datatable-input",loading:"datatable-loading",pagination:"datatable-pagination",paginationList:"datatable-pagination-list",search:"datatable-search",selector:"datatable-selector",sorter:"datatable-sorter",table:"datatable-table bg-color",top:"datatable-top text-center",wrapper:"datatable-wrapper text-center"},data:this.datos})},complete:()=>{this.loaderService.deactivateInternalSignal(),this.categorySuscription?.unsubscribe(),this.category.nativeElement.querySelectorAll("[data-action]").forEach(t=>{t.addEventListener("click",s=>{let a=s.currentTarget,n=a.getAttribute("data-action");this.mode.set(n==="edit"?"modify":"create"),this.categoryId.set(+a.getAttribute("data-id")),n==="create"&&this.resetForm.set(!0)})})},error:e=>{console.error("Error al obtener categor\xEDas:",e)}})}deleteCategory(){console.log("deleteCategory"),this.loaderService.activateInternalSignal(),this.categoryDeletedSuscription=this.categoryService.deleteCategory(this.categoryId()).subscribe({next:e=>{this.fetchCategories(),this.categoryCreated.set(!1),this.toastr.success("Categor\xEDa eliminada exitosamente")},complete:()=>{this.categoryDeletedSuscription?.unsubscribe(),this.loaderService.deactivateInternalSignal()},error:e=>{console.error("Error al eliminar categor\xEDa:",e),this.toastr.error(e.error.message)}})}ngAfterViewInit(){this.fetchCategories()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=pe({type:i,selectors:[["app-categories"]],viewQuery:function(t,s){if(t&1&&Me(ns,5),t&2){let a;Ee(a=Ne())&&(s.category=a.first)}},decls:10,vars:6,consts:[["categoryWrapper",""],["category",""],["type","button","data-modal-target","createCategory","data-modal-toggle","createCategory",1,"button-internal-module",3,"click"],[1,"fa-solid","fa-plus"],[1,"ml-2"],[3,"categoryCreatedSignal","mode","categoryId","categories","resetForm"],[3,"actionCreateCategor"]],template:function(t,s){if(t&1){let a=De();L(0,"button",2),me("click",function(){return Ce(a),s.mode.set("create"),xe(s.resetForm.set(!0))}),B(1,"span",3),L(2,"span",4),F(3,"Nueva categor\xEDa"),P()(),B(4,"app-create-category",5),L(5,"div",null,0),B(7,"table",null,1),P(),B(9,"app-delete-category",6)}t&2&&(W(4),te("categoryCreatedSignal",s.categoryCreated)("mode",s.mode)("categoryId",s.categoryId)("categories",s.categoriesSend)("resetForm",s.resetForm),W(5),te("actionCreateCategor",s.actionDeleteCategory))},dependencies:[ke,Ie,Se],encapsulation:2})};export{at as default};
