import{a as le}from"./chunk-G5KA7DMQ.js";import{a as se}from"./chunk-N7KMSJ3L.js";import"./chunk-UISL6Y2D.js";import{a as ne}from"./chunk-L3V7LWUT.js";import{b as oe}from"./chunk-MS4GMOMR.js";import"./chunk-BGKHSOXA.js";import{a as de}from"./chunk-22XGGMEN.js";import{b as Y,c as x,d as Z,e as J,f as K,h as ee,i as te,n as ae,o as ie,p as re}from"./chunk-7WT757UQ.js";import{a as M}from"./chunk-WRBWQDOP.js";import{a as X}from"./chunk-S4Z3L45U.js";import{h as $,n as b}from"./chunk-VGTGXULN.js";import{$ as T,Bb as y,Cb as C,Db as V,Eb as s,Gb as N,Ja as l,Jb as R,N as G,Oa as O,Pa as D,T as p,Ua as u,Yb as B,Za as L,_,aa as Q,ba as W,db as c,eb as U,ib as h,ma as z,mb as r,na as v,nb as o,ob as d,rb as I,wb as f}from"./chunk-SNWDAWOK.js";var g=class n{environments=ne;http=p(X);createNewVariante(a){return console.log(a.value),this.http.post(this.environments.URL_CREATE_VARIANTE,a.value)}getVariants(){return this.http.get(this.environments.URL_GET_VARIANTE)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})};var pe=["createVariante"],me=n=>({"border-red-500!":n});function ce(n,a){n&1&&(r(0,"p",11),s(1,"Este campo es requerido"),o())}function ue(n,a){n&1&&(r(0,"p",11),s(1,"El nombre debe tener al menos 3 caracteres"),o())}function fe(n,a){n&1&&(r(0,"p",11),s(1,"Este campo es requerido"),o())}function ve(n,a){n&1&&(r(0,"p",11),s(1,"El nombre debe tener al menos 3 caracteres"),o())}var F=class n{createVariantSubscription;fb=p(ae);loaderService=p(M);toastr=p(se);createVarianteService=p(g);variantsCreatedSignal;variante=[];variantsId;mode;resetForm;createVariante;textModalmodify={title:"Actualizar Variante",button:"Modificar"};textModalCreate={title:"Crear Variante",button:"Crear"};form=this.fb.group({name:["",[x.required,x.minLength(3)]],description:["",[x.required,x.minLength(3)]],id_business:[""]});createVariants(){this.loaderService.activateInternalSignal();let{id_business:a}=le(localStorage.getItem("auth_token"));this.form.get("id_business")?.setValue(a),this.mode()==="create"?this.createVariantSubscription=this.createVarianteService.createNewVariante(this.form).subscribe({next:t=>{console.log(t)},complete:()=>{this.createVariante.nativeElement.classList.add("hidden"),this.loaderService.deactivateInternalSignal(),this.toastr.success("Categor\xEDa creada exitosamente"),this.form.reset()},error:t=>{console.error("Error en la creaci\xF3n de la variante:",t),this.loaderService.deactivateInternalSignal(),this.toastr.error(t.error.message),this.form.reset()}}):console.log("update")}ngOnDestroy(){this.createVariantSubscription.unsubscribe()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=u({type:n,selectors:[["app-create-variants"]],viewQuery:function(t,e){if(t&1&&y(pe,5),t&2){let i;C(i=V())&&(e.createVariante=i.first)}},inputs:{variantsCreatedSignal:"variantsCreatedSignal",variante:"variante",variantsId:"variantsId",mode:"mode",resetForm:"resetForm"},decls:27,vars:14,consts:[["createVariante",""],["id","createVariante","tabindex","-1",1,"absolute","hidden","flex","top-0","left-0","backdrop-blur-xs","w-full","items-start","pt-15","h-full","z-10"],[1,"w-sm","md:w-md","lg:w-lg","h-fit","bg-color","rounded-xl","p-5","relative","animate-fadeIn"],["data-modal-hide","createVariante","aria-hidden","true",1,"fa-solid","fa-close","absolute","right-3","top-3","cursor-pointer","text-xl"],[1,"flex","justify-center"],[1,"h4","mb-2"],[1,"fa","fa-home"],[1,"mt-5",3,"ngSubmit","formGroup"],[1,"mb-3","relative"],["for","name",1,"label-behavior"],["type","text","id","name","formControlName","name","placeholder","Escribe el nombre de la categor\xEDa",1,"input-behavior",3,"ngClass"],[1,"text-red-500","text-sm","absolute"],["for","description",1,"label-behavior"],["name","description","id","description","formControlName","description","placeholder","Escribe una descripcion",1,"input-behavior",3,"ngClass"],[1,"mb-3","mt-8","flex","justify-center"],["type","submit",1,"button-create",3,"disabled"],[1,"fa","fa-check"]],template:function(t,e){if(t&1){let i=I();r(0,"div",1,0)(2,"div",2),d(3,"span",3),r(4,"div",4)(5,"h4",5),d(6,"span",6),s(7),o()(),d(8,"hr"),r(9,"form",7),f("ngSubmit",function(){return _(i),T(e.createVariants())}),r(10,"div",8)(11,"label",9),s(12,"Nombre"),o(),d(13,"input",10),L(14,ce,2,0,"p",11)(15,ue,2,0,"p",11),o(),r(16,"div")(17,"label",12),s(18,"Descripci\xF3n"),o(),r(19,"textarea",13),s(20,"        "),o(),L(21,fe,2,0,"p",11)(22,ve,2,0,"p",11),o(),r(23,"div",14)(24,"button",15),d(25,"span",16),s(26),o()()()()()}if(t&2){let i,m,q,E,w,H;l(7),N(" ",e.mode()==="create"?e.textModalCreate.title:e.textModalmodify.title,""),l(2),c("formGroup",e.form),l(4),c("ngClass",R(10,me,((i=e.form.get("name"))==null?null:i.hasError("required"))&&((i=e.form.get("name"))==null?null:i.touched))),l(),h((m=e.form.get("name"))!=null&&m.hasError("required")&&((m=e.form.get("name"))!=null&&m.touched)?14:-1),l(),h((q=e.form.get("name"))!=null&&q.hasError("minlength")?15:-1),l(4),c("ngClass",R(12,me,((E=e.form.get("description"))==null?null:E.hasError("required"))&&((E=e.form.get("description"))==null?null:E.touched))),l(2),h((w=e.form.get("description"))!=null&&w.hasError("required")&&((w=e.form.get("description"))!=null&&w.touched)?21:-1),l(),h((H=e.form.get("description"))!=null&&H.hasError("minlength")?22:-1),l(2),c("disabled",e.form.invalid),l(2),N(" ",e.mode()==="create"?e.textModalCreate.button:e.textModalmodify.button," Variante")}},dependencies:[b,$,ie,K,Y,Z,J,re,ee,te,oe],encapsulation:2})};var A=class n{actionCreateVariante;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=u({type:n,selectors:[["app-eliminar-variante"]],inputs:{actionCreateVariante:"actionCreateVariante"},decls:16,vars:0,consts:[["id","delete-modal","tabindex","-1",1,"backdrop-blur-xs","hidden","overflow-y-auto","overflow-x-hidden","absolute","top-0","right-0","left-0","z-50","justify-center","items-center","w-full","md:inset-0","h-[calc(100%-1rem)]","max-h-full"],[1,"relative","p-4","w-full","max-w-md","max-h-full"],[1,"relative","bg-color","rounded-xl","animate-fadeIn"],["type","button","data-modal-hide","delete-modal",1,"absolute","cursor-pointer","top-3","end-2.5","text-gray-400","bg-transparent","hover:bg-gray-200","hover:text-gray-900","rounded-lg","text-sm","w-8","h-8","ms-auto","inline-flex","justify-center","items-center","dark:hover:bg-gray-600","dark:hover:text-white"],["type","button",1,"fa-solid","fa-close","cursor-pointer","text-xl"],[1,"sr-only"],[1,"p-4","md:p-5","text-center"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 20 20",1,"mx-auto","mb-4","text-gray-400","w-12","h-12","dark:text-gray-200"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"],[1,"mb-5","text-lg","font-normal","text-gray-500","dark:text-gray-400"],["data-modal-hide","delete-modal","type","button",1,"text-white","bg-red-600","hover:bg-red-800","focus:ring-4","focus:outline-none","focus:ring-red-300","dark:focus:ring-red-800","font-medium","rounded-lg","text-sm","inline-flex","items-center","px-5","py-2.5","text-center",3,"click"],["data-modal-hide","delete-modal","type","button",1,"py-2.5","px-5","ms-3","text-sm","font-medium","text-gray-900","focus:outline-none","bg-white","rounded-lg","border","border-gray-200","hover:bg-gray-100","hover:text-blue-700","focus:z-10","focus:ring-4","focus:ring-gray-100","dark:focus:ring-gray-700","dark:bg-gray-800","dark:text-gray-400","dark:border-gray-600","dark:hover:text-white","dark:hover:bg-gray-700"]],template:function(t,e){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),d(4,"span",4),r(5,"span",5),s(6,"Close modal"),o()(),r(7,"div",6),Q(),r(8,"svg",7),d(9,"path",8),o(),W(),r(10,"h3",9),s(11,"Estas seguro de eliminar esta Variante?"),o(),r(12,"button",10),f("click",function(){return e.actionCreateVariante.set(!0)}),s(13," Si, eliminar "),o(),r(14,"button",11),s(15," No, cancelar "),o()()()()())},encapsulation:2})};var S=class n{constructor(a,t){this.renderer=a;this.el=t}visible=!1;text="";position={top:0,left:0,right:0};dataId=null;hideTimeout;keepVisible=!1;showAtElement(a,t){this.text=t;let e=a.getBoundingClientRect();this.position.top=e.top+window.scrollY-this.el.nativeElement.offsetHeight-50,this.position.left=e.left+window.scrollX+e.width/10,this.visible=!0}hide(){this.visible=!1,this.keepVisible=!1,this.text=""}onMouseEnter(){this.keepVisible=!0,this.hideTimeout&&clearTimeout(this.hideTimeout)}onMouseLeave(){this.keepVisible=!1,this.hideTimeout=setTimeout(()=>{this.keepVisible||this.hide()},200)}static \u0275fac=function(t){return new(t||n)(D(O),D(z))};static \u0275cmp=u({type:n,selectors:[["app-popover"]],decls:1,vars:9,consts:[[1,"popover-content","text-sm","text-gray-500","bg-white","border","border-gray-200","rounded-sm","shadow-xs","dark:text-gray-400","dark:border-gray-600","dark:bg-gray-800","p-3",3,"mouseenter","mouseleave","innerText"]],template:function(t,e){t&1&&(r(0,"div",0),f("mouseenter",function(){return e.onMouseEnter()})("mouseleave",function(){return e.onMouseLeave()}),o()),t&2&&(U("top",e.position.top,"px")("left",e.position.left,"px")("position","fixed")("display",e.visible?"block":"none"),c("innerText",e.text))},dependencies:[b],styles:[`.popover-content{z-index:9999;min-width:150px;pointer-events:auto;transition:opacity .5s ease-in-out}
`],encapsulation:2})};var be=["variantWrapper"],j=class n{popover;variant;variantsCreated=v(!1);variantSuscription;loaderService=p(M);variantService=p(g);dataTableInstance;variantSend=[];mode=v("");resetForm=v(!1);actionDeleteVariante=v(!1);variantsId=v(0);variantes=[];constructor(){B(()=>{this.variantsCreated()&&(this.fetchVariants(),this.variantsCreated.set(!1)),this.actionDeleteVariante()&&(this.deleteVariante(),this.actionDeleteVariante.set(!1))})}datos={headings:["nombre","descripcion","estado","opciones"],data:[]};fetchVariants(){this.loaderService.activateInternalSignal(),this.variantSuscription=this.variantService.getVariants().subscribe({next:a=>{this.variantes=a.map(t=>[t.name,t.description,t.isActive,t.id]),this.variantSend=a,this.datos.data=this.variantes,this.dataTableInstance&&this.dataTableInstance.destroy(),this.dataTableInstance=new de(this.variant.nativeElement,{searchable:!0,paging:!0,sortable:!0,columns:[{select:2,type:"string",render:function(t,e,i,m){return t?'<div class="text-center w-full"><span class="fa fa-check text-green-500"></span> Activo</div>':'<div class="text-center w-full"><span class="fa fa-times text-red-500"></span> Inactivo</div>'}},{select:3,type:"string",render:function(t,e,i,m){return`
                  <div class="flex justify-center items-center gap-5 w-full">
                    <button type="button" data-id="${t}" data-action="edit" data-popover-text="Actualizar Variante" class="button-edit" data-modal-target="createVariante" data-modal-toggle="createVariante">
                      <span class="fa-solid fa-pen-to-square"></span>
                    </button>
                    <button type="button" data-id="${t}" data-popover-text="Eliminar Variante"  data-action="delete" class="button-cancel" data-modal-target="delete-modal" data-modal-toggle="delete-modal">
                      <span class="fa-solid fa-trash"></span>
                    </button>
                    <button type="button" data-id="${t}" data-popover-text="Crear nuevo valor para esta variante" class="button-create" aria-label="Crear valor">
                      <span class="fa-solid fa-plus"></span>
                    </button>



                  </div>
                `}}],classes:{active:"datatable-active",bottom:"datatable-bottom",container:"datatable-container",cursor:"datatable-cursor",dropdown:"datatable-dropdown",ellipsis:"datatable-ellipsis",empty:"datatable-empty",headercontainer:"datatable-headercontainer",info:"datatable-info",input:"datatable-input",loading:"datatable-loading",pagination:"datatable-pagination",paginationList:"datatable-pagination-list",search:"datatable-search",selector:"datatable-selector",sorter:"datatable-sorter",table:"datatable-table bg-color",top:"datatable-top text-center",wrapper:"datatable-wrapper text-center"},data:this.datos})},complete:()=>{this.loaderService.deactivateInternalSignal(),this.variantSuscription?.unsubscribe();let a=this.variant.nativeElement;a.querySelectorAll("[data-action]").forEach(t=>{t.addEventListener("click",e=>{let i=e.currentTarget,m=i.getAttribute("data-action");this.mode.set(m==="edit"?"modify":"create"),this.variantsId.set(+i.getAttribute("data-id")),m==="create"&&this.resetForm.set(!0)})}),a.addEventListener("mouseover",t=>{let i=t.target.closest("[data-popover-text]");if(i){let m=i.getAttribute("data-popover-text")||"";this.popover.showAtElement(i,m)}}),a.addEventListener("mouseout",t=>{let e=t.relatedTarget;t.target.closest("[data-popover-text]")&&(!e||!e.closest("[data-popover-text]")&&!e.closest("app-popover"))&&this.popover.hide()})},error:a=>{this.loaderService.deactivateInternalSignal(),console.error("Error al obtener las variantes:",a)}})}deleteVariante(){}ngOnInit(){this.loaderService.deactivateInternalSignal()}ngAfterViewInit(){this.fetchVariants()}showPopover(a){let t=a.getAttribute("data-popover-text")??"Texto por defecto";this.popover.showAtElement(a,t)}hidePopover(){this.popover.hide()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=u({type:n,selectors:[["app-variants"]],viewQuery:function(t,e){if(t&1&&(y(S,5),y(be,5)),t&2){let i;C(i=V())&&(e.popover=i.first),C(i=V())&&(e.variant=i.first)}},decls:11,vars:6,consts:[["variantWrapper",""],["variant",""],["data-modal-target","createVariante","data-modal-toggle","createVariante","type","button",1,"button-internal-module",3,"click"],[1,"fa-solid","fa-plus"],[1,"ml-2"],[3,"variantsCreatedSignal","mode","variantsId","variante","resetForm"],[3,"actionCreateVariante"]],template:function(t,e){if(t&1){let i=I();r(0,"button",2),f("click",function(){return _(i),e.mode.set("create"),T(e.resetForm.set(!0))}),d(1,"span",3),r(2,"span",4),s(3,"Nueva Variante"),o()(),d(4,"app-create-variants",5),r(5,"div",null,0),d(7,"table",null,1),o(),d(9,"app-eliminar-variante",6)(10,"app-popover")}t&2&&(l(4),c("variantsCreatedSignal",e.variantsCreated)("mode",e.mode)("variantsId",e.variantsId)("variante",e.variantSend)("resetForm",e.resetForm),l(5),c("actionCreateVariante",e.actionDeleteVariante))},dependencies:[F,b,A,S],encapsulation:2})};export{j as default};
